<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bootstrap Diagnostics Guide • tsbs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap Diagnostics Guide">
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tsbs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bootstrap_diagnostics.html">Bootstrap Diagnostics Guide</a></li>
    <li><a class="dropdown-item" href="../articles/cgarch_vs_dcc.html">Copula GARCH vs DCC: Model Comparison and Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/dcc_inference_guide.html">DCC Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_diagnostics.html">Diagnostic System for MS-VARMA-GARCH Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_inference.html">MS-VARMA-GARCH Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_garch_comparison.html">Multivariate GARCH Model Comparison: DCC, CGARCH, and GOGARCH</a></li>
    <li><a class="dropdown-item" href="../articles/portfolio-optimization-demo.html">Portfolio Optimization with Multivariate GARCH Model Comparison</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bootstrap Diagnostics Guide</h1>
            <h3 data-toc-skip class="subtitle">Understanding and
Analyzing Bootstrap Output in tsbs</h3>
                        <h4 data-toc-skip class="author">tsbs
Package</h4>
            
            <h4 data-toc-skip class="date">2026-01-31</h4>
      

      <div class="d-none name"><code>bootstrap_diagnostics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The tsbs package provides a comprehensive diagnostics system for
analyzing bootstrap output. When you run <code><a href="../reference/tsbs.html">tsbs()</a></code> with
<code>return_diagnostics = TRUE</code>, you receive detailed information
about:</p>
<ul>
<li>
<strong>Block composition</strong>: How bootstrap series are
constructed from blocks of the original data</li>
<li>
<strong>Block statistics</strong>: Distribution of block lengths and
starting positions</li>
<li>
<strong>Quality metrics</strong>: Comparison of original
vs. bootstrap series statistics</li>
<li>
<strong>Method-specific information</strong>: Parameters and
settings specific to each bootstrap type</li>
</ul>
<p>This vignette demonstrates how to use these diagnostics to understand
and validate your bootstrap analysis.</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mahovo.github.io/tsbs/">tsbs</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate sample data: AR(1) process</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run bootstrap with diagnostics enabled</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span></span>
<span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  block_length <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"moving"</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  func <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View diagnostics summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt;   tsbs Bootstrap Diagnostics Summary</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIGURATION:</span></span>
<span><span class="co">#&gt;   Bootstrap type: moving </span></span>
<span><span class="co">#&gt;   Original series length: 300 </span></span>
<span><span class="co">#&gt;   Number of variables: 1 </span></span>
<span><span class="co">#&gt;   Number of replicates: 100 </span></span>
<span><span class="co">#&gt;   Generated: 2026-01-31 10:05:43 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CONFIGURATION PARAMETERS:</span></span>
<span><span class="co">#&gt;   bs_type: moving</span></span>
<span><span class="co">#&gt;   block_type: overlapping</span></span>
<span><span class="co">#&gt;   taper_type: NA</span></span>
<span><span class="co">#&gt;   tukey_alpha: NA</span></span>
<span><span class="co">#&gt;   block_length: 10</span></span>
<span><span class="co">#&gt;   n_boot: 300</span></span>
<span><span class="co">#&gt;   num_blocks: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_boots: 100</span></span>
<span><span class="co">#&gt;   p: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   p_method: NA</span></span>
<span><span class="co">#&gt;   num_states: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP SERIES LENGTHS:</span></span>
<span><span class="co">#&gt;   Min: 300 </span></span>
<span><span class="co">#&gt;   Max: 300 </span></span>
<span><span class="co">#&gt;   Mean: 300 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BLOCK LENGTH STATISTICS:</span></span>
<span><span class="co">#&gt;   Total blocks sampled: 2993 </span></span>
<span><span class="co">#&gt;   Mean block length: 10.02 </span></span>
<span><span class="co">#&gt;   SD block length: 0.48 </span></span>
<span><span class="co">#&gt;   Min block length: 10 </span></span>
<span><span class="co">#&gt;   Max block length: 20 </span></span>
<span><span class="co">#&gt;   Median block length: 10 </span></span>
<span><span class="co">#&gt;   25th percentile: 10 </span></span>
<span><span class="co">#&gt;   75th percentile: 10 </span></span>
<span><span class="co">#&gt;   Mean blocks per replicate: 29.93 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORIGINAL vs BOOTSTRAP STATISTICS:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   MEANS:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: -0.1558 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: -0.1047 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.1271 </span></span>
<span><span class="co">#&gt;       Bias: 0.0511 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LAG-1 AUTOCORRELATION:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.6094 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.5377 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0467 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-diagnostics-object">The Diagnostics Object<a class="anchor" aria-label="anchor" href="#the-diagnostics-object"></a>
</h2>
<p>When <code>return_diagnostics = TRUE</code>, the result contains a
<code>diagnostics</code> element of class <code>tsbs_diagnostics</code>.
This object stores all diagnostic information and supports
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
methods.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic info</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; tsbs Bootstrap Diagnostics</span></span>
<span><span class="co">#&gt;   Type: moving </span></span>
<span><span class="co">#&gt;   Replicates: 100 </span></span>
<span><span class="co">#&gt;   Original series: 300 x 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Use summary() for detailed diagnostics.</span></span>
<span><span class="co">#&gt; Use plot() for visualizations.</span></span>
<span></span>
<span><span class="co"># Check class</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tsbs_diagnostics"</span></span>
<span></span>
<span><span class="co"># View internal structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "meta"            "blocks"          "series_stats"    "original_stats" </span></span>
<span><span class="co">#&gt; [5] "method_specific" "config"</span></span></code></pre></div>
<div class="section level3">
<h3 id="structure-overview">Structure Overview<a class="anchor" aria-label="anchor" href="#structure-overview"></a>
</h3>
<p>The diagnostics object contains:</p>
<table class="table">
<colgroup>
<col width="45%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>meta</code></td>
<td>Metadata: bootstrap type, dimensions, timestamp</td>
</tr>
<tr class="even">
<td><code>blocks</code></td>
<td>Block composition data for each replicate</td>
</tr>
<tr class="odd">
<td><code>series_stats</code></td>
<td>Per-replicate statistics (means, SDs, autocorrelations)</td>
</tr>
<tr class="even">
<td><code>original_stats</code></td>
<td>Reference statistics from original series</td>
</tr>
<tr class="odd">
<td><code>method_specific</code></td>
<td>Bootstrap method-specific diagnostics</td>
</tr>
<tr class="even">
<td><code>config</code></td>
<td>Configuration parameters used</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="diagnostic-summary">Diagnostic Summary<a class="anchor" aria-label="anchor" href="#diagnostic-summary"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method provides a comprehensive text
report covering all aspects of the bootstrap analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt;   tsbs Bootstrap Diagnostics Summary</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIGURATION:</span></span>
<span><span class="co">#&gt;   Bootstrap type: moving </span></span>
<span><span class="co">#&gt;   Original series length: 300 </span></span>
<span><span class="co">#&gt;   Number of variables: 1 </span></span>
<span><span class="co">#&gt;   Number of replicates: 100 </span></span>
<span><span class="co">#&gt;   Generated: 2026-01-31 10:05:43 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CONFIGURATION PARAMETERS:</span></span>
<span><span class="co">#&gt;   bs_type: moving</span></span>
<span><span class="co">#&gt;   block_type: overlapping</span></span>
<span><span class="co">#&gt;   taper_type: NA</span></span>
<span><span class="co">#&gt;   tukey_alpha: NA</span></span>
<span><span class="co">#&gt;   block_length: 10</span></span>
<span><span class="co">#&gt;   n_boot: 300</span></span>
<span><span class="co">#&gt;   num_blocks: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_boots: 100</span></span>
<span><span class="co">#&gt;   p: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   p_method: NA</span></span>
<span><span class="co">#&gt;   num_states: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP SERIES LENGTHS:</span></span>
<span><span class="co">#&gt;   Min: 300 </span></span>
<span><span class="co">#&gt;   Max: 300 </span></span>
<span><span class="co">#&gt;   Mean: 300 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BLOCK LENGTH STATISTICS:</span></span>
<span><span class="co">#&gt;   Total blocks sampled: 2993 </span></span>
<span><span class="co">#&gt;   Mean block length: 10.02 </span></span>
<span><span class="co">#&gt;   SD block length: 0.48 </span></span>
<span><span class="co">#&gt;   Min block length: 10 </span></span>
<span><span class="co">#&gt;   Max block length: 20 </span></span>
<span><span class="co">#&gt;   Median block length: 10 </span></span>
<span><span class="co">#&gt;   25th percentile: 10 </span></span>
<span><span class="co">#&gt;   75th percentile: 10 </span></span>
<span><span class="co">#&gt;   Mean blocks per replicate: 29.93 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORIGINAL vs BOOTSTRAP STATISTICS:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   MEANS:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: -0.1558 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: -0.1047 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.1271 </span></span>
<span><span class="co">#&gt;       Bias: 0.0511 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LAG-1 AUTOCORRELATION:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.6094 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.5377 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0467 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<div class="section level3">
<h3 id="interpreting-the-summary">Interpreting the Summary<a class="anchor" aria-label="anchor" href="#interpreting-the-summary"></a>
</h3>
<p><strong>Bootstrap Configuration</strong>: Shows the bootstrap type,
series dimensions, and number of replicates.</p>
<p><strong>Configuration Parameters</strong>: Lists all parameters used,
including auto-computed values.</p>
<p><strong>Bootstrap Series Lengths</strong>: For methods that can
produce variable-length series, shows the distribution of lengths.</p>
<p><strong>Block Length Statistics</strong>: For block-based methods
(moving, stationary, HMM, MSVAR), shows:</p>
<ul>
<li>Total number of blocks sampled across all replicates</li>
<li>Mean, SD, min, max, and median block lengths</li>
<li>Quartiles (25th and 75th percentiles)</li>
<li>Average blocks per replicate</li>
</ul>
<p><strong>Original vs Bootstrap Statistics</strong>: Compares key
statistics between the original series and bootstrap replicates:</p>
<ul>
<li>Means: Original value, bootstrap average, bootstrap SD, and
bias</li>
<li>Lag-1 Autocorrelation: How well the bootstrap preserves temporal
dependence</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="visualizations">Visualizations<a class="anchor" aria-label="anchor" href="#visualizations"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method generates diagnostic visualizations.
You can request specific plot types or generate all applicable
plots.</p>
<div class="section level3">
<h3 id="available-plot-types">Available Plot Types<a class="anchor" aria-label="anchor" href="#available-plot-types"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All applicable plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specific plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"block_lengths"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"start_positions"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"means_comparison"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"acf_comparison"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"length_distribution"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="block-length-distribution">Block Length Distribution<a class="anchor" aria-label="anchor" href="#block-length-distribution"></a>
</h3>
<p>Shows how block lengths are distributed across all bootstrap
replicates. For moving block bootstrap, this should be constant; for
stationary bootstrap, it follows a geometric distribution.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"block_lengths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_diagnostics_files/figure-html/plot-block-lengths-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level3">
<h3 id="starting-position-distribution">Starting Position Distribution<a class="anchor" aria-label="anchor" href="#starting-position-distribution"></a>
</h3>
<p>Shows where blocks are sampled from in the original series. A uniform
distribution indicates good coverage of the original data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"start_positions"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="means-comparison">Means Comparison<a class="anchor" aria-label="anchor" href="#means-comparison"></a>
</h3>
<p>Compares the distribution of bootstrap means against the original
series mean. The red dashed line shows the original value.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"means_comparison"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_diagnostics_files/figure-html/plot-means-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level3">
<h3 id="autocorrelation-comparison">Autocorrelation Comparison<a class="anchor" aria-label="anchor" href="#autocorrelation-comparison"></a>
</h3>
<p>Shows how well the bootstrap preserves the lag-1 autocorrelation
structure of the original series.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"acf_comparison"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_diagnostics_files/figure-html/plot-acf-1.png" class="r-plt" alt="" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="extracting-diagnostic-data">Extracting Diagnostic Data<a class="anchor" aria-label="anchor" href="#extracting-diagnostic-data"></a>
</h2>
<p>For custom analysis, you can extract diagnostic data in various
formats.</p>
<div class="section level3">
<h3 id="block-information">Block Information<a class="anchor" aria-label="anchor" href="#block-information"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all block information</span></span>
<span><span class="va">blocks_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_blocks.html">extract_blocks</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">blocks_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   block_num length start_pos block_type replicate</span></span>
<span><span class="co">#&gt; 1         1     10        32  estimated         1</span></span>
<span><span class="co">#&gt; 2         2     10       152  estimated         1</span></span>
<span><span class="co">#&gt; 3         3     10       248  estimated         1</span></span>
<span><span class="co">#&gt; 4         4     10       208  estimated         1</span></span>
<span><span class="co">#&gt; 5         5     10        92  estimated         1</span></span>
<span><span class="co">#&gt; 6         6     10        34  estimated         1</span></span>
<span></span>
<span><span class="co"># Get blocks for a specific replicate</span></span>
<span><span class="va">blocks_rep1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_blocks.html">extract_blocks</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, replicate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">blocks_rep1</span></span>
<span><span class="co">#&gt;    block_num length start_pos block_type</span></span>
<span><span class="co">#&gt; 1          1     10        32  estimated</span></span>
<span><span class="co">#&gt; 2          2     10       152  estimated</span></span>
<span><span class="co">#&gt; 3          3     10       248  estimated</span></span>
<span><span class="co">#&gt; 4          4     10       208  estimated</span></span>
<span><span class="co">#&gt; 5          5     10        92  estimated</span></span>
<span><span class="co">#&gt; 6          6     10        34  estimated</span></span>
<span><span class="co">#&gt; 7          7     10       168  estimated</span></span>
<span><span class="co">#&gt; 8          8     10       242  estimated</span></span>
<span><span class="co">#&gt; 9          9     10       152  estimated</span></span>
<span><span class="co">#&gt; 10        10     10       202  estimated</span></span>
<span><span class="co">#&gt; 11        11     10       146  estimated</span></span>
<span><span class="co">#&gt; 12        12     10       104  estimated</span></span>
<span><span class="co">#&gt; 13        13     10       281  estimated</span></span>
<span><span class="co">#&gt; 14        14     10       269  estimated</span></span>
<span><span class="co">#&gt; 15        15     10        60  estimated</span></span>
<span><span class="co">#&gt; 16        16     10       278  estimated</span></span>
<span><span class="co">#&gt; 17        17     10       255  estimated</span></span>
<span><span class="co">#&gt; 18        18     10       203  estimated</span></span>
<span><span class="co">#&gt; 19        19     10       150  estimated</span></span>
<span><span class="co">#&gt; 20        20     10       140  estimated</span></span>
<span><span class="co">#&gt; 21        21     10        59  estimated</span></span>
<span><span class="co">#&gt; 22        22     10        30  estimated</span></span>
<span><span class="co">#&gt; 23        23     10       138  estimated</span></span>
<span><span class="co">#&gt; 24        24     10        91  estimated</span></span>
<span><span class="co">#&gt; 25        25     10       225  estimated</span></span>
<span><span class="co">#&gt; 26        26     10       263  estimated</span></span>
<span><span class="co">#&gt; 27        27     10        98  estimated</span></span>
<span><span class="co">#&gt; 28        28     10       240  estimated</span></span>
<span><span class="co">#&gt; 29        29     10        65  estimated</span></span>
<span><span class="co">#&gt; 30        30     10       223  estimated</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summary-statistics">Summary Statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get comprehensive summary statistics</span></span>
<span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_summary_stats.html">extract_summary_stats</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Original series statistics</span></span>
<span><span class="va">stats</span><span class="op">$</span><span class="va">original</span></span>
<span><span class="co">#&gt; $means</span></span>
<span><span class="co">#&gt; [1] -0.1558061</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sds</span></span>
<span><span class="co">#&gt; [1] 1.218115</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ac1</span></span>
<span><span class="co">#&gt; [1] 0.6093509</span></span>
<span></span>
<span><span class="co"># Bootstrap statistics with quantiles</span></span>
<span><span class="va">stats</span><span class="op">$</span><span class="va">bootstrap</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] -0.1046991</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 0.1271038</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $quantiles</span></span>
<span><span class="co">#&gt;               [,1]</span></span>
<span><span class="co">#&gt; 2.5%  -0.334849152</span></span>
<span><span class="co">#&gt; 25%   -0.181688481</span></span>
<span><span class="co">#&gt; 50%   -0.120980348</span></span>
<span><span class="co">#&gt; 75%   -0.008973198</span></span>
<span><span class="co">#&gt; 97.5%  0.119517941</span></span>
<span></span>
<span><span class="co"># Block length statistics</span></span>
<span><span class="va">stats</span><span class="op">$</span><span class="va">block_lengths</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 10.02339</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 0.4831253</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $min</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $median</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="converting-to-data-frame">Converting to Data Frame<a class="anchor" aria-label="anchor" href="#converting-to-data-frame"></a>
</h3>
<p>For integration with other analysis workflows, convert diagnostics to
a data frame.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Per-replicate statistics</span></span>
<span><span class="va">stats_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, what <span class="op">=</span> <span class="st">"stats"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stats_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   replicate length       mean_V1    sd_V1    ac1_V1</span></span>
<span><span class="co">#&gt; 1         1    300 -0.0004595378 1.170248 0.5127383</span></span>
<span><span class="co">#&gt; 2         2    300 -0.0555913842 1.155754 0.5488788</span></span>
<span><span class="co">#&gt; 3         3    300 -0.0701734837 1.126817 0.5444252</span></span>
<span><span class="co">#&gt; 4         4    300 -0.1803415829 1.204624 0.5368394</span></span>
<span><span class="co">#&gt; 5         5    300 -0.0836004992 1.151282 0.4644822</span></span>
<span><span class="co">#&gt; 6         6    300  0.2862128585 1.129703 0.4405106</span></span>
<span></span>
<span><span class="co"># Block-level data</span></span>
<span><span class="va">blocks_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, what <span class="op">=</span> <span class="st">"blocks"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">blocks_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   block_num length start_pos block_type replicate</span></span>
<span><span class="co">#&gt; 1         1     10        32  estimated         1</span></span>
<span><span class="co">#&gt; 2         2     10       152  estimated         1</span></span>
<span><span class="co">#&gt; 3         3     10       248  estimated         1</span></span>
<span><span class="co">#&gt; 4         4     10       208  estimated         1</span></span>
<span><span class="co">#&gt; 5         5     10        92  estimated         1</span></span>
<span><span class="co">#&gt; 6         6     10        34  estimated         1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-type-examples">Bootstrap Type Examples<a class="anchor" aria-label="anchor" href="#bootstrap-type-examples"></a>
</h2>
<p>Different bootstrap methods provide different diagnostic information.
This section demonstrates diagnostics for each supported method.</p>
<div class="section level3">
<h3 id="moving-block-bootstrap">Moving Block Bootstrap<a class="anchor" aria-label="anchor" href="#moving-block-bootstrap"></a>
</h3>
<p>The moving block bootstrap samples fixed-length, overlapping blocks
from the original series.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">x_ar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_mbb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_ar</span>,</span>
<span>  block_length <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"moving"</span>,</span>
<span>  block_type <span class="op">=</span> <span class="st">"overlapping"</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_mbb</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt;   tsbs Bootstrap Diagnostics Summary</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIGURATION:</span></span>
<span><span class="co">#&gt;   Bootstrap type: moving </span></span>
<span><span class="co">#&gt;   Original series length: 200 </span></span>
<span><span class="co">#&gt;   Number of variables: 1 </span></span>
<span><span class="co">#&gt;   Number of replicates: 100 </span></span>
<span><span class="co">#&gt;   Generated: 2026-01-31 10:05:45 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CONFIGURATION PARAMETERS:</span></span>
<span><span class="co">#&gt;   bs_type: moving</span></span>
<span><span class="co">#&gt;   block_type: overlapping</span></span>
<span><span class="co">#&gt;   taper_type: NA</span></span>
<span><span class="co">#&gt;   tukey_alpha: NA</span></span>
<span><span class="co">#&gt;   block_length: 12</span></span>
<span><span class="co">#&gt;   n_boot: 200</span></span>
<span><span class="co">#&gt;   num_blocks: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_boots: 100</span></span>
<span><span class="co">#&gt;   p: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   p_method: NA</span></span>
<span><span class="co">#&gt;   num_states: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP SERIES LENGTHS:</span></span>
<span><span class="co">#&gt;   Min: 200 </span></span>
<span><span class="co">#&gt;   Max: 200 </span></span>
<span><span class="co">#&gt;   Mean: 200 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BLOCK LENGTH STATISTICS:</span></span>
<span><span class="co">#&gt;   Total blocks sampled: 1688 </span></span>
<span><span class="co">#&gt;   Mean block length: 11.85 </span></span>
<span><span class="co">#&gt;   SD block length: 1.38 </span></span>
<span><span class="co">#&gt;   Min block length: 8 </span></span>
<span><span class="co">#&gt;   Max block length: 24 </span></span>
<span><span class="co">#&gt;   Median block length: 12 </span></span>
<span><span class="co">#&gt;   25th percentile: 12 </span></span>
<span><span class="co">#&gt;   75th percentile: 12 </span></span>
<span><span class="co">#&gt;   Mean blocks per replicate: 16.88 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORIGINAL vs BOOTSTRAP STATISTICS:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   MEANS:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: -0.0018 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: -0.0176 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.1312 </span></span>
<span><span class="co">#&gt;       Bias: -0.0158 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LAG-1 AUTOCORRELATION:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.5159 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.4697 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.061 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<p><strong>Key diagnostics for moving block bootstrap:</strong></p>
<ul>
<li>Block lengths should all equal the specified
<code>block_length</code>
</li>
<li>Starting positions should be roughly uniformly distributed</li>
<li>Autocorrelation preservation depends on block length relative to
data persistence</li>
</ul>
</div>
<div class="section level3">
<h3 id="stationary-bootstrap">Stationary Bootstrap<a class="anchor" aria-label="anchor" href="#stationary-bootstrap"></a>
</h3>
<p>The stationary bootstrap uses geometrically distributed block
lengths, providing a stationary resampling scheme.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_sb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_ar</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"stationary"</span>,</span>
<span>  p_method <span class="op">=</span> <span class="st">"plugin"</span>,  <span class="co"># Auto-select p based on autocorrelation</span></span>
<span>  n_boot <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_sb</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt;   tsbs Bootstrap Diagnostics Summary</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIGURATION:</span></span>
<span><span class="co">#&gt;   Bootstrap type: stationary </span></span>
<span><span class="co">#&gt;   Original series length: 200 </span></span>
<span><span class="co">#&gt;   Number of variables: 1 </span></span>
<span><span class="co">#&gt;   Number of replicates: 100 </span></span>
<span><span class="co">#&gt;   Generated: 2026-01-31 10:05:46 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CONFIGURATION PARAMETERS:</span></span>
<span><span class="co">#&gt;   bs_type: stationary</span></span>
<span><span class="co">#&gt;   block_type: overlapping</span></span>
<span><span class="co">#&gt;   taper_type: NA</span></span>
<span><span class="co">#&gt;   tukey_alpha: NA</span></span>
<span><span class="co">#&gt;   block_length: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   n_boot: 200</span></span>
<span><span class="co">#&gt;   num_blocks: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_boots: 100</span></span>
<span><span class="co">#&gt;   p: 0.484146996484453</span></span>
<span><span class="co">#&gt;   p_method: plugin</span></span>
<span><span class="co">#&gt;   num_states: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP SERIES LENGTHS:</span></span>
<span><span class="co">#&gt;   Min: 200 </span></span>
<span><span class="co">#&gt;   Max: 200 </span></span>
<span><span class="co">#&gt;   Mean: 200 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BLOCK LENGTH STATISTICS:</span></span>
<span><span class="co">#&gt;   Total blocks sampled: 9796 </span></span>
<span><span class="co">#&gt;   Mean block length: 2.04 </span></span>
<span><span class="co">#&gt;   SD block length: 1.38 </span></span>
<span><span class="co">#&gt;   Min block length: 1 </span></span>
<span><span class="co">#&gt;   Max block length: 11 </span></span>
<span><span class="co">#&gt;   Median block length: 2 </span></span>
<span><span class="co">#&gt;   25th percentile: 1 </span></span>
<span><span class="co">#&gt;   75th percentile: 3 </span></span>
<span><span class="co">#&gt;   Mean blocks per replicate: 97.96 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORIGINAL vs BOOTSTRAP STATISTICS:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   MEANS:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: -0.0018 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.0098 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0901 </span></span>
<span><span class="co">#&gt;       Bias: 0.0116 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LAG-1 AUTOCORRELATION:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.5159 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.2604 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0864 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; METHOD-SPECIFIC DIAGNOSTICS:</span></span>
<span><span class="co">#&gt;   p_estimated: 0.484146996484453</span></span>
<span><span class="co">#&gt;   expected_block_length: 2.06548838939686</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Block lengths follow geometric distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_sb</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"block_lengths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_diagnostics_files/figure-html/stationary-plot-1.png" class="r-plt" alt="" width="672"></p>
<p><strong>Key diagnostics for stationary bootstrap:</strong></p>
<ul>
<li>Block lengths follow a geometric distribution</li>
<li>
<code>p_estimated</code> shows the geometric parameter used</li>
<li>
<code>expected_block_length</code> = 1/p gives the theoretical mean
block length</li>
<li>Actual mean block length may differ due to truncation at series
boundaries</li>
</ul>
</div>
<div class="section level3">
<h3 id="tapered-block-bootstrap">Tapered Block Bootstrap<a class="anchor" aria-label="anchor" href="#tapered-block-bootstrap"></a>
</h3>
<p>Tapered blocks apply window functions to smooth transitions between
blocks.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_tapered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_ar</span>,</span>
<span>  block_length <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"moving"</span>,</span>
<span>  block_type <span class="op">=</span> <span class="st">"tapered"</span>,</span>
<span>  taper_type <span class="op">=</span> <span class="st">"tukey"</span>,</span>
<span>  tukey_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_tapered</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt;   tsbs Bootstrap Diagnostics Summary</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIGURATION:</span></span>
<span><span class="co">#&gt;   Bootstrap type: moving </span></span>
<span><span class="co">#&gt;   Original series length: 200 </span></span>
<span><span class="co">#&gt;   Number of variables: 1 </span></span>
<span><span class="co">#&gt;   Number of replicates: 50 </span></span>
<span><span class="co">#&gt;   Generated: 2026-01-31 10:05:47 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CONFIGURATION PARAMETERS:</span></span>
<span><span class="co">#&gt;   bs_type: moving</span></span>
<span><span class="co">#&gt;   block_type: tapered</span></span>
<span><span class="co">#&gt;   taper_type: tukey</span></span>
<span><span class="co">#&gt;   tukey_alpha: 0.5</span></span>
<span><span class="co">#&gt;   block_length: 15</span></span>
<span><span class="co">#&gt;   n_boot: 200</span></span>
<span><span class="co">#&gt;   num_blocks: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_boots: 50</span></span>
<span><span class="co">#&gt;   p: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   p_method: NA</span></span>
<span><span class="co">#&gt;   num_states: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP SERIES LENGTHS:</span></span>
<span><span class="co">#&gt;   Min: 200 </span></span>
<span><span class="co">#&gt;   Max: 200 </span></span>
<span><span class="co">#&gt;   Mean: 200 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BLOCK LENGTH STATISTICS:</span></span>
<span><span class="co">#&gt;   Total blocks sampled: 5438 </span></span>
<span><span class="co">#&gt;   Mean block length: 1.84 </span></span>
<span><span class="co">#&gt;   SD block length: 3.21 </span></span>
<span><span class="co">#&gt;   Min block length: 1 </span></span>
<span><span class="co">#&gt;   Max block length: 16 </span></span>
<span><span class="co">#&gt;   Median block length: 1 </span></span>
<span><span class="co">#&gt;   25th percentile: 1 </span></span>
<span><span class="co">#&gt;   75th percentile: 1 </span></span>
<span><span class="co">#&gt;   Mean blocks per replicate: 108.76 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORIGINAL vs BOOTSTRAP STATISTICS:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   MEANS:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: -0.0018 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: -0.016 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.1457 </span></span>
<span><span class="co">#&gt;       Bias: -0.0142 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LAG-1 AUTOCORRELATION:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.5159 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.4533 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0899 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<p><strong>Note</strong>: Tapered blocks modify values at block
boundaries, which affects the block length estimation heuristic. The
estimated block lengths may not perfectly match the actual blocks
used.</p>
</div>
<div class="section level3">
<h3 id="wild-bootstrap">Wild Bootstrap<a class="anchor" aria-label="anchor" href="#wild-bootstrap"></a>
</h3>
<p>The wild bootstrap multiplies observations by random signs (±1),
preserving heteroskedasticity patterns. It does not use blocks.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">321</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate heteroskedastic data</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span><span class="va">sigma_t</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">/</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="va">sigma_t</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_wild</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">residuals</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"wild"</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_wild</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt;   tsbs Bootstrap Diagnostics Summary</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIGURATION:</span></span>
<span><span class="co">#&gt;   Bootstrap type: wild </span></span>
<span><span class="co">#&gt;   Original series length: 150 </span></span>
<span><span class="co">#&gt;   Number of variables: 1 </span></span>
<span><span class="co">#&gt;   Number of replicates: 200 </span></span>
<span><span class="co">#&gt;   Generated: 2026-01-31 10:05:48 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CONFIGURATION PARAMETERS:</span></span>
<span><span class="co">#&gt;   bs_type: wild</span></span>
<span><span class="co">#&gt;   block_type: overlapping</span></span>
<span><span class="co">#&gt;   taper_type: NA</span></span>
<span><span class="co">#&gt;   tukey_alpha: NA</span></span>
<span><span class="co">#&gt;   block_length: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   n_boot: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_blocks: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_boots: 200</span></span>
<span><span class="co">#&gt;   p: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   p_method: NA</span></span>
<span><span class="co">#&gt;   num_states: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP SERIES LENGTHS:</span></span>
<span><span class="co">#&gt;   Min: 150 </span></span>
<span><span class="co">#&gt;   Max: 150 </span></span>
<span><span class="co">#&gt;   Mean: 150 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORIGINAL vs BOOTSTRAP STATISTICS:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   MEANS:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.0665 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.0024 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0811 </span></span>
<span><span class="co">#&gt;       Bias: -0.0641 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LAG-1 AUTOCORRELATION:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: -0.0167 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: -0.0156 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0919 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<p><strong>Key diagnostics for wild bootstrap:</strong></p>
<ul>
<li>No block statistics (wild bootstrap doesn’t use blocks)</li>
<li>Series length always equals original length</li>
<li>Mean should be approximately zero (signs are randomized)</li>
<li>Variance structure is preserved</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_wild</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"means_comparison"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_diagnostics_files/figure-html/wild-plot-1.png" class="r-plt" alt="" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-series">Multivariate Series<a class="anchor" aria-label="anchor" href="#multivariate-series"></a>
</h2>
<p>The diagnostics system fully supports multivariate time series,
providing per-variable statistics.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">555</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate correlated bivariate series</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">innovations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x_mv</span> <span class="op">&lt;-</span> <span class="va">innovations</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add persistence</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x_mv</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x_mv</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x_mv</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">result_mv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_mv</span>,</span>
<span>  block_length <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"moving"</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_mv</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt;   tsbs Bootstrap Diagnostics Summary</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIGURATION:</span></span>
<span><span class="co">#&gt;   Bootstrap type: moving </span></span>
<span><span class="co">#&gt;   Original series length: 200 </span></span>
<span><span class="co">#&gt;   Number of variables: 2 </span></span>
<span><span class="co">#&gt;   Number of replicates: 100 </span></span>
<span><span class="co">#&gt;   Generated: 2026-01-31 10:05:48 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CONFIGURATION PARAMETERS:</span></span>
<span><span class="co">#&gt;   bs_type: moving</span></span>
<span><span class="co">#&gt;   block_type: overlapping</span></span>
<span><span class="co">#&gt;   taper_type: NA</span></span>
<span><span class="co">#&gt;   tukey_alpha: NA</span></span>
<span><span class="co">#&gt;   block_length: 10</span></span>
<span><span class="co">#&gt;   n_boot: 200</span></span>
<span><span class="co">#&gt;   num_blocks: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   num_boots: 100</span></span>
<span><span class="co">#&gt;   p: NULL (auto-computed)</span></span>
<span><span class="co">#&gt;   p_method: NA</span></span>
<span><span class="co">#&gt;   num_states: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BOOTSTRAP SERIES LENGTHS:</span></span>
<span><span class="co">#&gt;   Min: 200 </span></span>
<span><span class="co">#&gt;   Max: 200 </span></span>
<span><span class="co">#&gt;   Mean: 200 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BLOCK LENGTH STATISTICS:</span></span>
<span><span class="co">#&gt;   Total blocks sampled: 1993 </span></span>
<span><span class="co">#&gt;   Mean block length: 10.04 </span></span>
<span><span class="co">#&gt;   SD block length: 0.59 </span></span>
<span><span class="co">#&gt;   Min block length: 10 </span></span>
<span><span class="co">#&gt;   Max block length: 20 </span></span>
<span><span class="co">#&gt;   Median block length: 10 </span></span>
<span><span class="co">#&gt;   25th percentile: 10 </span></span>
<span><span class="co">#&gt;   75th percentile: 10 </span></span>
<span><span class="co">#&gt;   Mean blocks per replicate: 19.93 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORIGINAL vs BOOTSTRAP STATISTICS:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   MEANS:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.0191 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.0175 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0449 </span></span>
<span><span class="co">#&gt;       Bias: -0.0016 </span></span>
<span><span class="co">#&gt;     Variable 2 :</span></span>
<span><span class="co">#&gt;       Original: 0.0171 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.0259 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0661 </span></span>
<span><span class="co">#&gt;       Bias: 0.0088 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LAG-1 AUTOCORRELATION:</span></span>
<span><span class="co">#&gt;     Variable 1 :</span></span>
<span><span class="co">#&gt;       Original: 0.3195 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.2934 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0634 </span></span>
<span><span class="co">#&gt;     Variable 2 :</span></span>
<span><span class="co">#&gt;       Original: 0.3538 </span></span>
<span><span class="co">#&gt;       Bootstrap avg: 0.2995 </span></span>
<span><span class="co">#&gt;       Bootstrap SD: 0.0883 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Means comparison shows both variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_mv</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"means_comparison"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_diagnostics_files/figure-html/multivariate-plots-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># ACF comparison for each variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_mv</span><span class="op">$</span><span class="va">diagnostics</span>, type <span class="op">=</span> <span class="st">"acf_comparison"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_diagnostics_files/figure-html/multivariate-plots-2.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level2">
<h2 id="custom-analysis-examples">Custom Analysis Examples<a class="anchor" aria-label="anchor" href="#custom-analysis-examples"></a>
</h2>
<p>The extracted diagnostic data enables custom analyses beyond the
built-in summaries.</p>
<div class="section level3">
<h3 id="bootstrap-confidence-intervals">Bootstrap Confidence Intervals<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract bootstrap means</span></span>
<span><span class="va">stats_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, what <span class="op">=</span> <span class="st">"stats"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute percentile confidence interval</span></span>
<span><span class="va">ci_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">stats_df</span><span class="op">$</span><span class="va">mean_V1</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95% Bootstrap CI for mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ci_95</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 95% Bootstrap CI for mean: -0.3348 0.1195</span></span>
<span></span>
<span><span class="co"># Compare to original</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">original_stats</span><span class="op">$</span><span class="va">means</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original mean: -0.1558</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="assessing-autocorrelation-preservation">Assessing Autocorrelation Preservation<a class="anchor" aria-label="anchor" href="#assessing-autocorrelation-preservation"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How well does the bootstrap preserve autocorrelation?</span></span>
<span><span class="va">orig_ac1</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">original_stats</span><span class="op">$</span><span class="va">ac1</span></span>
<span><span class="va">boot_ac1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">series_stats</span><span class="op">$</span><span class="va">replicate_ac1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bias in autocorrelation</span></span>
<span><span class="va">ac1_bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_ac1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="va">orig_ac1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original AC(1):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">orig_ac1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original AC(1): 0.6094</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Bootstrap AC(1) mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_ac1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Bootstrap AC(1) mean: 0.5377</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"AC(1) bias:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ac1_bias</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; AC(1) bias: -0.0717</span></span>
<span></span>
<span><span class="co"># What fraction of bootstrap replicates have AC(1) within 0.1 of original?</span></span>
<span><span class="va">within_tolerance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">boot_ac1</span> <span class="op">-</span> <span class="va">orig_ac1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fraction within ±0.1 of original:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">within_tolerance</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fraction within ±0.1 of original: 0.73</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="block-coverage-analysis">Block Coverage Analysis<a class="anchor" aria-label="anchor" href="#block-coverage-analysis"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze how well the bootstrap covers the original series</span></span>
<span><span class="va">blocks_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_blocks.html">extract_blocks</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Distribution of starting positions</span></span>
<span><span class="va">start_positions</span> <span class="op">&lt;-</span> <span class="va">blocks_df</span><span class="op">$</span><span class="va">start_pos</span></span>
<span></span>
<span><span class="co"># Divide original series into deciles and count block starts</span></span>
<span><span class="va">n_orig</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_original</span></span>
<span><span class="va">decile_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_orig</span>, length.out <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">decile_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">start_positions</span>, breaks <span class="op">=</span> <span class="va">decile_breaks</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">counts</span></span>
<span></span>
<span><span class="co"># Check for uniform coverage (chi-square test)</span></span>
<span><span class="va">expected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">start_positions</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span><span class="va">chi_sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">decile_counts</span> <span class="op">-</span> <span class="va">expected</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">expected</span><span class="op">)</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">chi_sq</span>, df <span class="op">=</span> <span class="fl">9</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Chi-square test for uniform block coverage:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Chi-square test for uniform block coverage:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Chi-square statistic:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">chi_sq</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Chi-square statistic: 30.81</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  p-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p_value</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   p-value: 3e-04</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Interpretation:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&gt;</span> <span class="fl">0.05</span>, </span>
<span>                                 <span class="st">"Coverage appears uniform"</span>, </span>
<span>                                 <span class="st">"Coverage may be non-uniform"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Interpretation: Coverage may be non-uniform</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-bootstrap-methods">Comparing Bootstrap Methods<a class="anchor" aria-label="anchor" href="#comparing-bootstrap-methods"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare moving vs stationary bootstrap</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span>
<span><span class="va">x_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_moving</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_compare</span>,</span>
<span>  block_length <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"moving"</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_stationary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_compare</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="st">"stationary"</span>,</span>
<span>  block_length <span class="op">=</span> <span class="fl">10</span>,  <span class="co"># Expected block length</span></span>
<span>  n_boot <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare AC(1) preservation</span></span>
<span><span class="va">ac1_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">x_compare</span>, lag.max <span class="op">=</span> <span class="fl">1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">acf</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">ac1_moving</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">result_moving</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">series_stats</span><span class="op">$</span><span class="va">replicate_ac1</span><span class="op">)</span></span>
<span><span class="va">ac1_stationary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">result_stationary</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">series_stats</span><span class="op">$</span><span class="va">replicate_ac1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"Moving Block"</span>, <span class="st">"Stationary"</span><span class="op">)</span>,</span>
<span>  `AC(1) Mean` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ac1_orig</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ac1_moving</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ac1_stationary</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `AC(1) SD` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ac1_moving</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ac1_stationary</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison</span>, digits <span class="op">=</span> <span class="fl">4</span>, </span>
<span>             caption <span class="op">=</span> <span class="st">"Autocorrelation Preservation by Bootstrap Method"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Autocorrelation Preservation by Bootstrap Method</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">AC(1) Mean</th>
<th align="right">AC(1) SD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Original</td>
<td align="right">0.7576</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Moving Block</td>
<td align="right">0.6862</td>
<td align="right">0.0488</td>
</tr>
<tr class="odd">
<td align="left">Stationary</td>
<td align="right">0.6479</td>
<td align="right">0.0607</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="choosing-block-length">Choosing Block Length<a class="anchor" aria-label="anchor" href="#choosing-block-length"></a>
</h3>
<p>The block length is a critical parameter for block bootstrap methods.
Use diagnostics to assess your choice:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Try different block lengths and compare AC(1) preservation</span></span>
<span><span class="va">block_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">ac1_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">block_lengths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">bl</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsbs.html">tsbs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_ar</span>, block_length <span class="op">=</span> <span class="va">bl</span>, bs_type <span class="op">=</span> <span class="st">"moving"</span>,</span>
<span>              n_boot <span class="op">=</span> <span class="fl">200</span>, num_boots <span class="op">=</span> <span class="fl">100</span>, return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">boot_ac1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">res</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">series_stats</span><span class="op">$</span><span class="va">replicate_ac1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_ac1</span><span class="op">)</span>, bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">boot_ac1</span><span class="op">)</span> <span class="op">-</span> <span class="va">res</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">original_stats</span><span class="op">$</span><span class="va">ac1</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="assessing-bootstrap-quality">Assessing Bootstrap Quality<a class="anchor" aria-label="anchor" href="#assessing-bootstrap-quality"></a>
</h3>
<p>Key indicators of bootstrap quality:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Low bias</strong>: Bootstrap means close to original</li>
<li>
<strong>Good AC preservation</strong>: Bootstrap autocorrelation
close to original</li>
<li>
<strong>Uniform coverage</strong>: Blocks sampled evenly across
original series</li>
<li>
<strong>Appropriate variability</strong>: Bootstrap SD reflects
sampling uncertainty</li>
</ol>
</div>
<div class="section level3">
<h3 id="number-of-replicates">Number of Replicates<a class="anchor" aria-label="anchor" href="#number-of-replicates"></a>
</h3>
<p>More replicates provide more stable estimates but increase
computation time. Use diagnostics to assess convergence:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check if bootstrap mean has stabilized</span></span>
<span><span class="va">stats_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">diagnostics</span>, what <span class="op">=</span> <span class="st">"stats"</span><span class="op">)</span></span>
<span><span class="va">running_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">stats_df</span><span class="op">$</span><span class="va">mean_V1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">stats_df</span><span class="op">$</span><span class="va">mean_V1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">running_mean</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Replicate"</span>, ylab <span class="op">=</span> <span class="st">"Running Mean"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Bootstrap Mean Convergence"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The tsbs diagnostics system provides comprehensive tools for
understanding and validating bootstrap analyses:</p>
<table class="table">
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code></td>
<td>Comprehensive text report</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code></td>
<td>Diagnostic visualizations</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/extract_blocks.html">extract_blocks()</a></code></td>
<td>Block composition data</td>
</tr>
<tr class="even">
<td><code><a href="../reference/extract_summary_stats.html">extract_summary_stats()</a></code></td>
<td>Statistical summaries</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code></td>
<td>Convert to data frame for custom analysis</td>
</tr>
</tbody>
</table>
<p>By examining these diagnostics, you can:</p>
<ul>
<li>Verify bootstrap configuration</li>
<li>Assess how well temporal dependence is preserved</li>
<li>Identify potential issues with block selection</li>
<li>Compare different bootstrap methods</li>
<li>Build confidence in your bootstrap inference</li>
</ul>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] tsbs_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] tidyselect_1.2.1            dplyr_1.1.4                </span></span>
<span><span class="co">#&gt;   [3] farver_2.1.2                S7_0.2.1                   </span></span>
<span><span class="co">#&gt;   [5] fastmap_1.2.0               tsgarch_1.0.3              </span></span>
<span><span class="co">#&gt;   [7] JADE_2.0-4                  fontquiver_0.2.1           </span></span>
<span><span class="co">#&gt;   [9] GeneralizedHyperbolic_0.8-7 digest_0.6.39              </span></span>
<span><span class="co">#&gt;  [11] timechange_0.4.0            lifecycle_1.0.5            </span></span>
<span><span class="co">#&gt;  [13] cluster_2.1.8.1             tsmarch_1.0.0              </span></span>
<span><span class="co">#&gt;  [15] Rsolnp_2.0.1                mev_2.1                    </span></span>
<span><span class="co">#&gt;  [17] magrittr_2.0.4              compiler_4.5.2             </span></span>
<span><span class="co">#&gt;  [19] rlang_1.1.7                 sass_0.4.10                </span></span>
<span><span class="co">#&gt;  [21] tools_4.5.2                 yaml_2.3.12                </span></span>
<span><span class="co">#&gt;  [23] data.table_1.18.2.1         knitr_1.51                 </span></span>
<span><span class="co">#&gt;  [25] labeling_0.4.3              askpass_1.2.1              </span></span>
<span><span class="co">#&gt;  [27] curl_7.0.0                  alabama_2025.1.0           </span></span>
<span><span class="co">#&gt;  [29] xml2_1.5.2                  TTR_0.24.4                 </span></span>
<span><span class="co">#&gt;  [31] RColorBrewer_1.1-3          abind_1.4-8                </span></span>
<span><span class="co">#&gt;  [33] KernSmooth_2.23-26          withr_3.0.2                </span></span>
<span><span class="co">#&gt;  [35] nleqslv_3.3.5               purrr_1.2.1                </span></span>
<span><span class="co">#&gt;  [37] numDeriv_2016.8-1.1         desc_1.4.3                 </span></span>
<span><span class="co">#&gt;  [39] grid_4.5.2                  gdtools_0.4.4              </span></span>
<span><span class="co">#&gt;  [41] xts_0.14.1                  future_1.69.0              </span></span>
<span><span class="co">#&gt;  [43] progressr_0.18.0            ggplot2_4.0.1              </span></span>
<span><span class="co">#&gt;  [45] iterators_1.0.14            globals_0.18.0             </span></span>
<span><span class="co">#&gt;  [47] scales_1.4.0                MASS_7.3-65                </span></span>
<span><span class="co">#&gt;  [49] cli_3.6.5                   rmarkdown_2.30             </span></span>
<span><span class="co">#&gt;  [51] ragg_1.5.0                  generics_0.1.4             </span></span>
<span><span class="co">#&gt;  [53] RcppParallel_5.1.11-1       RcppBessel_1.0.0           </span></span>
<span><span class="co">#&gt;  [55] future.apply_1.20.1         cachem_1.1.0               </span></span>
<span><span class="co">#&gt;  [57] parallel_4.5.2              vctrs_0.7.1                </span></span>
<span><span class="co">#&gt;  [59] Matrix_1.7-4                sandwich_3.1-1             </span></span>
<span><span class="co">#&gt;  [61] jsonlite_2.0.0              fontBitstreamVera_0.1.1    </span></span>
<span><span class="co">#&gt;  [63] clue_0.3-66                 listenv_0.10.0             </span></span>
<span><span class="co">#&gt;  [65] systemfonts_1.3.1           foreach_1.5.2              </span></span>
<span><span class="co">#&gt;  [67] tidyr_1.3.2                 jquerylib_0.1.4            </span></span>
<span><span class="co">#&gt;  [69] quantmod_0.4.28             glue_1.8.0                 </span></span>
<span><span class="co">#&gt;  [71] parallelly_1.46.1           pkgdown_2.2.0              </span></span>
<span><span class="co">#&gt;  [73] nloptr_2.2.1                SkewHyperbolic_0.4-2       </span></span>
<span><span class="co">#&gt;  [75] codetools_0.2-20            DistributionUtils_0.6-2    </span></span>
<span><span class="co">#&gt;  [77] shape_1.4.6.1               lubridate_1.9.4            </span></span>
<span><span class="co">#&gt;  [79] flextable_0.9.10            gtable_0.3.6               </span></span>
<span><span class="co">#&gt;  [81] tsmethods_1.0.2             tibble_3.3.1               </span></span>
<span><span class="co">#&gt;  [83] pillar_1.11.1               htmltools_0.5.9            </span></span>
<span><span class="co">#&gt;  [85] openssl_2.3.4               truncnorm_1.0-9            </span></span>
<span><span class="co">#&gt;  [87] R6_2.6.1                    TMB_1.9.19                 </span></span>
<span><span class="co">#&gt;  [89] textshaping_1.0.4           Rdpack_2.6.5               </span></span>
<span><span class="co">#&gt;  [91] evaluate_1.0.5              lattice_0.22-7             </span></span>
<span><span class="co">#&gt;  [93] rbibutils_2.4.1             fontLiberation_0.1.0       </span></span>
<span><span class="co">#&gt;  [95] bslib_0.10.0                Rcpp_1.1.1                 </span></span>
<span><span class="co">#&gt;  [97] zip_2.3.3                   uuid_1.2-2                 </span></span>
<span><span class="co">#&gt;  [99] officer_0.7.3               xfun_0.56                  </span></span>
<span><span class="co">#&gt; [101] fs_1.6.6                    zoo_1.8-15                 </span></span>
<span><span class="co">#&gt; [103] pkgconfig_2.0.3             tsdistributions_1.0.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Hoshi Vognsen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
