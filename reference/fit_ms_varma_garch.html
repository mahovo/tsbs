<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a Flexible N-State Markov-Switching Vector-ARMA-GARCH Model — fit_ms_varma_garch • tsbs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Flexible N-State Markov-Switching Vector-ARMA-GARCH Model — fit_ms_varma_garch"><meta name="description" content="This function provides a user-friendly interface to fit a general Markov-Switching
model. It handles data validation, pre-processing, calls the C++ estimation
engine, and formats the results into a well-structured object."><meta property="og:description" content="This function provides a user-friendly interface to fit a general Markov-Switching
model. It handles data validation, pre-processing, calls the C++ estimation
engine, and formats the results into a well-structured object."><meta property="og:image" content="https://mahovo.github.io/tsbs/logo.png"><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tsbs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bootstrap_diagnostics.html">Bootstrap Diagnostics Guide</a></li>
    <li><a class="dropdown-item" href="../articles/cgarch_vs_dcc.html">Copula GARCH vs DCC: Model Comparison and Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/dcc_inference_guide.html">DCC Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_diagnostics.html">Diagnostic System for MS-VARMA-GARCH Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_inference.html">MS-VARMA-GARCH Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_garch_comparison.html">Multivariate GARCH Model Comparison: DCC, CGARCH, and GOGARCH</a></li>
    <li><a class="dropdown-item" href="../articles/portfolio-optimization-demo.html">Portfolio Optimization with Multivariate GARCH Model Comparison</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit a Flexible N-State Markov-Switching Vector-ARMA-GARCH Model</h1>

      <div class="d-none name"><code>fit_ms_varma_garch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides a user-friendly interface to fit a general Markov-Switching
model. It handles data validation, pre-processing, calls the C++ estimation
engine, and formats the results into a well-structured object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_ms_varma_garch</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">spec</span>,</span>
<span>  model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"univariate"</span>, <span class="st">"multivariate"</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  collect_diagnostics <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose_file <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric matrix where rows are observations and columns are the
time series variables.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>An integer &gt;1 specifying the number of states in the Markov chain.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>An integer specifying the order of differencing to be applied to
the series before fitting. This order is constant across all states.
Defaults to 0 (no differencing), which is appropriate for returns data.</p></dd>


<dt id="arg-spec">spec<a class="anchor" aria-label="anchor" href="#arg-spec"></a></dt>
<dd><p>A list of model specifications, one for each of the M states.
See Details for the required structure.</p></dd>


<dt id="arg-model-type">model_type<a class="anchor" aria-label="anchor" href="#arg-model-type"></a></dt>
<dd><p>A character string, either "univariate" or "multivariate".
Defaults to "univariate".</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters for the EM algorithm, including:</p><ul><li><p>max_iterAn integer specifying the maximum number of EM iterations.
Defaults to 100.</p></li>
<li><p>tolA numeric value specifying the convergence tolerance for the
log-likelihood. Defaults to 1e-6.</p></li>
<li><p>dcc_boundary_thresholdThreshold for detecting boundary DCC
parameters (default 0.02).</p></li>
<li><p>dcc_boundary_criterionSelection criterion: "threshold", "aic", or
"bic" (default "bic").</p></li>
<li><p>dcc_allow_refittingLogical; if TRUE, allow refitting with constant
correlation when boundary parameters are detected (default TRUE).</p></li>
</ul></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical.</p></dd>


<dt id="arg-num-cores">num_cores<a class="anchor" aria-label="anchor" href="#arg-num-cores"></a></dt>
<dd><p>Number of cores.</p></dd>


<dt id="arg-collect-diagnostics">collect_diagnostics<a class="anchor" aria-label="anchor" href="#arg-collect-diagnostics"></a></dt>
<dd><p>Logical. Collect diagnostics or not.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, print detailed diagnostic information during
estimation. Default is FALSE.</p></dd>


<dt id="arg-verbose-file">verbose_file<a class="anchor" aria-label="anchor" href="#arg-verbose-file"></a></dt>
<dd><p>Character string specifying path to file for verbose output.
If NULL (default), verbose output goes to console. If specified, all verbose
output is written to this file instead. Only used if verbose = TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the full results of the estimation, including model
fits for each state, the transition matrix, smoothed probabilities, and
information criteria:</p><ul><li><p>model_fitsModel fits</p></li>
<li><p>PP</p></li>
<li><p>log_likelihoodLog-likelihood</p></li>
<li><p>smoothed_probabilitiesSmoothed probabilities</p></li>
<li><p>aicAIC</p></li>
<li><p>bicBIC</p></li>
<li><p>num_paramsNumber of parameters (used for AIC/BIC)</p></li>
<li><p>dOrder of differencing</p></li>
<li><p>yData matrix</p></li>
<li><p>callReturn the exact call to fit_ms_varma_garch()</p></li>
<li><p>convergenceConvergence</p></li>
<li><p>dcc_boundary_criterionDCC boundary criterion used</p></li>
<li><p>warningsWarnings</p></li>
<li><p>diagnosticsDiagnostics</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>spec</code> argument is a list of length <code>M</code>, where each element <code>spec[[j]]</code>
defines the model for state <code>j</code>. This state-specific list must contain:</p><ul><li><p>For the mean model: <code>arma_order</code> (univariate) or <code>var_order</code> (multivariate).</p></li>
<li><p>For the variance model: <code>garch_model</code> (e.g., "garch"), <code>garch_order</code>,
<code>distribution</code>, and for multivariate models, <code>garch_spec_fun</code> ("dcc_modelspec",
"cgarch_modelspec", or "gogarch_modelspec") and <code>garch_spec_args</code>.</p></li>
<li><p>Starting parameters: <code>start_pars</code>, a list containing <code>arma_pars</code> (or <code>var_pars</code>)
and <code>garch_pars</code>.</p></li>
</ul><p><strong>Multivariate Model Types:</strong></p><ul><li><p><code>dcc_modelspec</code>: Dynamic Conditional Correlation model. Estimates time-varying
correlations using the DCC recursion of Engle (2002).</p></li>
<li><p><code>cgarch_modelspec</code>: Copula GARCH model. Separates marginal distributions from
dependence structure using copula theory. Supports MVN and MVT copulas with
parametric, empirical, or SPD PIT transformations.</p></li>
<li><p><code>gogarch_modelspec</code>: Generalized Orthogonal GARCH model. Uses ICA to extract
independent components, then estimates univariate GARCH on each component.
Time-varying covariance arises from the fixed mixing matrix.</p></li>
</ul><p>For mathematical expression of the model see <code><a href="ms_varma_garch_bs.html">ms_varma_garch_bs()</a></code>.</p>
<p><strong>Parameter Counting for Information Criteria:</strong></p>
<p>The AIC and BIC are computed using the total number of estimated parameters,
which includes: mean model parameters (VAR coefficients), univariate GARCH
parameters, correlation dynamics parameters (for DCC/CGARCH), and transition
matrix parameters.</p>
<p>For GOGARCH models, the ICA mixing matrix is treated as a data transformation
rather than as estimated parameters for information criteria purposes. This is
consistent with the view that ICA extracts a fixed orthogonal rotation of the
data, analogous to principal components, rather than optimizing a likelihood
contribution. Consequently, GOGARCH models will have fewer counted parameters
than DCC/CGARCH models with the same number of series, which should be
considered when comparing models across different multivariate specifications.</p>
<p><strong>Note</strong>
For single-regime data, since M &gt; 1, and assuming we set M = 2:</p><ul><li><p>both states should converge to similar parameters,</p></li>
<li><p>or one state should have nearly zero probability.</p></li>
</ul><p>Check: <code>fit$smoothed_probabilities</code> - is one state dominant?</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="ms_varma_garch_bs.html">ms_varma_garch_bs</a></code>: Bootstrap inference for MS-VARMA-GARCH models</p></li>
<li><p><code><a href="estimate_garch_weighted_dcc.html">estimate_garch_weighted_dcc</a></code>: DCC estimation details</p></li>
<li><p><code><a href="estimate_garch_weighted_cgarch.html">estimate_garch_weighted_cgarch</a></code>: Copula GARCH estimation details</p></li>
<li><p><code><a href="estimate_garch_weighted_gogarch.html">estimate_garch_weighted_gogarch</a></code>: GOGARCH estimation details</p></li>
</ul></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Hoshi Vognsen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

