<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stationary Bootstrap for a General MS-VARMA-GARCH Model — ms_varma_garch_bs • tsbs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stationary Bootstrap for a General MS-VARMA-GARCH Model — ms_varma_garch_bs"><meta name="description" content="Fits a flexible \(n\)-state Markov-Switching Vector ARIMA\((p, d, q)\)-
GARCH model and then uses the estimated state sequence to perform a stationary
block bootstrap. This generates resampled time series that preserve the
state-dependent properties of the original data."><meta property="og:description" content="Fits a flexible \(n\)-state Markov-Switching Vector ARIMA\((p, d, q)\)-
GARCH model and then uses the estimated state sequence to perform a stationary
block bootstrap. This generates resampled time series that preserve the
state-dependent properties of the original data."><meta property="og:image" content="https://mahovo.github.io/tsbs/logo.png"><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tsbs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bootstrap_diagnostics.html">Bootstrap Diagnostics Guide</a></li>
    <li><a class="dropdown-item" href="../articles/cgarch_vs_dcc.html">Copula GARCH vs DCC: Model Comparison and Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/dcc_inference_guide.html">DCC Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_diagnostics.html">Diagnostic System for MS-VARMA-GARCH Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_inference.html">MS-VARMA-GARCH Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_garch_comparison.html">Multivariate GARCH Model Comparison: DCC, CGARCH, and GOGARCH</a></li>
    <li><a class="dropdown-item" href="../articles/portfolio-optimization-demo.html">Portfolio Optimization with Multivariate GARCH Model Comparison</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Stationary Bootstrap for a General MS-VARMA-GARCH Model</h1>

      <div class="d-none name"><code>ms_varma_garch_bs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a flexible \(n\)-state Markov-Switching Vector ARIMA\((p, d, q)\)-
GARCH model and then uses the estimated state sequence to perform a stationary
block bootstrap. This generates resampled time series that preserve the
state-dependent properties of the original data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ms_varma_garch_bs</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_blocks <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">spec</span>,</span>
<span>  model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"univariate"</span>, <span class="st">"multivariate"</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  return_fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  collect_diagnostics <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose_file <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric matrix where rows are observations and columns are the time
series variables.</p></dd>


<dt id="arg-n-boot">n_boot<a class="anchor" aria-label="anchor" href="#arg-n-boot"></a></dt>
<dd><p>An integer specifying the length of each bootstrapped series.
Default is <code>NULL</code>.</p></dd>


<dt id="arg-num-blocks">num_blocks<a class="anchor" aria-label="anchor" href="#arg-num-blocks"></a></dt>
<dd><p>An integer specifying the number of blocks to sample for
the bootstrap. Defaults to 100.</p></dd>


<dt id="arg-num-boots">num_boots<a class="anchor" aria-label="anchor" href="#arg-num-boots"></a></dt>
<dd><p>An integer specifying the total number of bootstrapped series
to generate. Defaults to 100.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>An integer specifying the number of states in the Markov chain.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>An integer specifying the order of differencing for the ARIMA model.</p></dd>


<dt id="arg-spec">spec<a class="anchor" aria-label="anchor" href="#arg-spec"></a></dt>
<dd><p>A list of model specifications, one for each of the M states.</p></dd>


<dt id="arg-model-type">model_type<a class="anchor" aria-label="anchor" href="#arg-model-type"></a></dt>
<dd><p>A character string, either "univariate" or "multivariate".</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters for the EM algorithm.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>A logical value indicating whether to use parallel processing.</p></dd>


<dt id="arg-num-cores">num_cores<a class="anchor" aria-label="anchor" href="#arg-num-cores"></a></dt>
<dd><p>An integer specifying the number of cores for parallel processing.</p></dd>


<dt id="arg-return-fit">return_fit<a class="anchor" aria-label="anchor" href="#arg-return-fit"></a></dt>
<dd><p>If <code>TRUE</code>, <code><a href="tsbs.html">tsbs()</a></code> will return model fit when
<code>bs_type = "ms_varma_garch"</code>. Default is <code>return_fit = FALSE</code>. If
<code>bs_type = "ms_varma_garch"</code>, <code>return_fit = TRUE</code> and
<code>collect_diagnostics = TRUE</code> diagnostics can be extracted from
<code>result$fit$diagnostics</code>. See <code>vignette("Diagnostics", package = "tsbs")</code>.</p></dd>


<dt id="arg-collect-diagnostics">collect_diagnostics<a class="anchor" aria-label="anchor" href="#arg-collect-diagnostics"></a></dt>
<dd><p>Logical. Collect diagnostics or not.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, print detailed diagnostic information during
estimation. Default is FALSE.</p></dd>


<dt id="arg-verbose-file">verbose_file<a class="anchor" aria-label="anchor" href="#arg-verbose-file"></a></dt>
<dd><p>Character string specifying path to file for verbose output.
If NULL (default), verbose output goes to console. If specified, all verbose
output is written to this file instead. Only used if verbose = TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of bootstrapped time series matrices.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>n_boot</code> is set, the last block will be trimmed when necessary.
If <code>n_boot</code> is not set, and <code>num_blocks</code> is set, the length of each
bootstrap series will be determined by the number of blocks and the random
lengths of the individual blocks for that particular series.
If neither <code>n_boot</code> nor <code>num_blocks</code> is set, <code>n_boot</code> will default to the
number of rows in <code>x</code> and the last block will be trimmed when necessary.</p>
<p>The fitted model is defined as:</p>
<p>Let \(y_t\) be the \(k \times 1\) vector of observations at time \(t\).
The model assumes that the data-generating process is governed by a latent
(unobserved) state variable, \(S_t\), which follows a first-order Markov
chain with \(M\) states.</p>
<ol><li><p><strong>State Process</strong>: The evolution of the state is described by the
\(M \times M\) transition probability matrix \(P\), where the element
\(p_{ij}\) is the probability of transitioning from state \(i\) to state \(j\):
$$p_{ij} = P(S_t = j | S_{t-1} = i)$$
The matrix \(P\) is structured such that \(P_{ij} = p_{ij}\), and its
rows sum to one: \(\sum_{j=1}^{M} p_{ij} = 1\) for all \(i=1, \dots, M\).</p></li>
<li><p><strong>Observation Process</strong>: Conditional on the system being in state
\(S_t = j\), each of the \(k\) time series, \(y_{i,t}\) for
\(i=1, \dots, k\), is assumed to follow an independent
ARIMA(\(p_j, d_j, q_j\))-GARCH(\(q'_j, p'_j\)) process. The parameters
for both the mean and variance equations are specific to the state \(j\).</p><ul><li><p><strong>Mean Equation (ARIMA)</strong>:
$$\phi_j(L)(1-L)^{d_j} (y_{i,t} - \mu_j) = \theta_j(L) \varepsilon_{i,t}$$
where \(\phi_j(L)\) and \(\theta_j(L)\) are the AR and MA lag
polynomials, \(\mu_j\) is the mean, and \(\varepsilon_{i,t}\) is the
innovation term, all specific to state \(j\).</p></li>
<li><p><strong>Variance Equation (GARCH)</strong>: The innovations have a conditional
variance \(\sigma_{i,t}^2\) that evolves according to:
$$\varepsilon_{i,t} = \sigma_{i,t} z_{i,t}, \quad z_{i,t} \sim \mathcal{N}(0,1)$$
$$\sigma_{i,t}^2 = \omega_j + \sum_{l=1}^{q'_j} \alpha_{j,l} \varepsilon_{i,t-l}^2 + \sum_{l=1}^{p'_j} \beta_{j,l} \sigma_{i,t-l}^2$$
where \(\omega_j, \alpha_{j,l}, \beta_{j,l}\) are the GARCH parameters for state \(j\).</p></li>
</ul></li>
</ol><p>Let \(\Psi_j = \{\mu_j, \phi_j, \theta_j, \omega_j, \alpha_j, \beta_j\}\) be
the complete set of ARIMA-GARCH parameters for state \(j\), and let
\(\Psi = \{\Psi_1, \dots, \Psi_M, P\}\) be the full parameter set for the
entire model. The EM algorithm using a Hamilton Filter &amp; Kim Smoother for the
E-step is used to find the Maximum Likelihood Estimate (MLE) of \(\Psi\).</p>
<p>The tsbs package uses different optimization strategies for DCC models
depending on the model order:</p>
<p><strong>DCC(1,1) - Reparameterized Optimization</strong></p>
<p>For the common DCC(1,1) case, we use a reparameterization that transforms
the constrained problem into an unconstrained one:</p><ul><li><p>Original: \(\alpha \in (0,1), \beta \in (0,1), \alpha + \beta &lt; 1\)</p></li>
<li><p>Reparameterized: \(persistence \in (0,1), ratio \in (0,1)\)</p></li>
</ul><p>where \(persistence = \alpha + \beta\) and \(ratio = \alpha/(\alpha + \beta)\).</p>
<p>This eliminates the stationarity constraint since \(\alpha + \beta = persistence &lt; 1\)
is automatically satisfied by the box constraint on persistence.</p>
<p>Benefits:</p><ul><li><p>No penalty function discontinuities</p></li>
<li><p>More stable optimization near high-persistence regions</p></li>
<li><p>Eliminates "dcc_penalty" warnings from optimizer exploration</p></li>
</ul><p><strong>DCC(p,q) with max(p,q) &gt; 1 - Penalty Method</strong></p>
<p>For higher-order DCC models, reparameterization becomes significantly more
complex (requiring softmax distributions over parameter vectors). We therefore
use the standard penalty method:</p><ul><li><p>Box constraints: \(\alpha_j, \beta_j \in (\epsilon, 1-\epsilon)\)</p></li>
<li><p>Stationarity enforced via penalty when \(\sum \alpha + \sum \beta \geq 1\)</p></li>
</ul><p>This may result in optimizer instability warnings for models with high
persistence.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Natatou Moutari, D. et al. (2021). Dependence Modeling and Risk Assessment
of a Financial Portfolio with ARMA-APARCH-EVT models based on HACs.
<a href="http://arxiv.org/abs/2105.09473" class="external-link">arXiv:2105.09473</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Hoshi Vognsen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

