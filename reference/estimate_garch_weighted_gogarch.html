<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Weighted GARCH Estimation for GOGARCH Models — estimate_garch_weighted_gogarch • tsbs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weighted GARCH Estimation for GOGARCH Models — estimate_garch_weighted_gogarch"><meta name="description" content="Implements weighted maximum likelihood estimation for Generalized Orthogonal
GARCH (GOGARCH) models in the context of Markov-Switching frameworks.
GOGARCH differs fundamentally from DCC and Copula GARCH in how it models
dynamic correlations:
DCC/CGARCH: Estimate explicit correlation dynamics parameters
(alpha, beta) that govern how correlations evolve over time.
GOGARCH: Assume observations arise from independent latent
factors. Time-varying correlations emerge from the time-varying volatilities
of these factors, transformed through a fixed mixing matrix.

"><meta property="og:description" content="Implements weighted maximum likelihood estimation for Generalized Orthogonal
GARCH (GOGARCH) models in the context of Markov-Switching frameworks.
GOGARCH differs fundamentally from DCC and Copula GARCH in how it models
dynamic correlations:
DCC/CGARCH: Estimate explicit correlation dynamics parameters
(alpha, beta) that govern how correlations evolve over time.
GOGARCH: Assume observations arise from independent latent
factors. Time-varying correlations emerge from the time-varying volatilities
of these factors, transformed through a fixed mixing matrix.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tsbs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bootstrap_diagnostics.html">Bootstrap Diagnostics Guide</a></li>
    <li><a class="dropdown-item" href="../articles/cgarch_vs_dcc.html">Copula GARCH vs DCC: Model Comparison and Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/dcc_inference_guide.html">DCC Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_diagnostics.html">Diagnostic System for MS-VARMA-GARCH Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_inference.html">MS-VARMA-GARCH Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_garch_comparison.html">Multivariate GARCH Model Comparison: DCC, CGARCH, and GOGARCH</a></li>
    <li><a class="dropdown-item" href="../articles/portfolio-optimization-demo.html">Portfolio Optimization with Multivariate GARCH Model Comparison</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Weighted GARCH Estimation for GOGARCH Models</h1>

      <div class="d-none name"><code>estimate_garch_weighted_gogarch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements weighted maximum likelihood estimation for Generalized Orthogonal
GARCH (GOGARCH) models in the context of Markov-Switching frameworks.</p>
<p>GOGARCH differs fundamentally from DCC and Copula GARCH in how it models
dynamic correlations:</p><ul><li><p><strong>DCC/CGARCH</strong>: Estimate explicit correlation dynamics parameters
(alpha, beta) that govern how correlations evolve over time.</p></li>
<li><p><strong>GOGARCH</strong>: Assume observations arise from independent latent
factors. Time-varying correlations emerge from the time-varying volatilities
of these factors, transformed through a fixed mixing matrix.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_garch_weighted_gogarch</span><span class="op">(</span></span>
<span>  <span class="va">residuals</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">spec</span>,</span>
<span>  diagnostics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-residuals">residuals<a class="anchor" aria-label="anchor" href="#arg-residuals"></a></dt>
<dd><p>Numeric matrix of residuals with dimensions T x k, where T is
the number of observations and k is the number of series.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Numeric vector of state probabilities/weights with length T.
These weights come from the E-step of the EM algorithm in the MS-VARMA-GARCH
framework.</p></dd>


<dt id="arg-spec">spec<a class="anchor" aria-label="anchor" href="#arg-spec"></a></dt>
<dd><p>List containing the model specification with the following elements:</p><dl><dt><code>garch_spec_args</code></dt>
<dd><p>List with:</p><ul><li><p><code>model</code>: GARCH model type (default: <code>"garch"</code>). Valid
choices are “garch” for vanilla GARCH, “gjrgarch” for asymmetric
GARCH, “egarch” for exponential GARCH, “aparch” for asymmetric
power ARCH, “csGARCH” for the component GARCH, “igarch” for the
integrated GARCH.</p></li>
<li><p><code>order</code>: GARCH order as c(p, q) (default: <code>c(1, 1)</code>)</p></li>
<li><p><code>ica</code>: ICA algorithm. Currently only <code>"radical"</code> is
supported (via tsmarch v1.0.0)</p></li>
<li><p><code>components</code>: Number of ICA components to extract</p></li>
</ul></dd>

<dt><code>distribution</code></dt>
<dd><p>Component distribution: <code>"norm"</code>,
<code>"nig"</code>, or <code>"gh"</code></p></dd>

<dt><code>start_pars</code></dt>
<dd><p>List with:</p><ul><li><p><code>garch_pars</code>: List of starting GARCH parameters for each
component (e.g., <code>list(list(omega=0.1, alpha1=0.1, beta1=0.8), ...)</code>)</p></li>
<li><p><code>dist_pars</code>: Distribution parameters (e.g.,
<code>list(shape=1, skew=0)</code> for NIG)</p></li>
</ul></dd>


</dl></dd>


<dt id="arg-diagnostics">diagnostics<a class="anchor" aria-label="anchor" href="#arg-diagnostics"></a></dt>
<dd><p>Optional diagnostics collector object for logging
estimation progress and issues.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, print progress information during
ICA decomposition and GARCH estimation. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p><dl><dt><code>coefficients</code></dt>
<dd><p>List containing:</p><ul><li><p><code>garch_pars</code>: List of estimated GARCH parameters for each
ICA component</p></li>
<li><p><code>ica_info</code>: List with ICA results:</p><ul><li><p><code>A</code>: Mixing matrix (k x n_components)</p></li>
<li><p><code>W</code>: Unmixing matrix (n_components x k)</p></li>
<li><p><code>K</code>: Pre-whitening matrix (for Jacobian)</p></li>
<li><p><code>S</code>: Independent components matrix (T x n_components)</p></li>
<li><p><code>method</code>: ICA algorithm used</p></li>
<li><p><code>n_components</code>: Number of components extracted</p></li>
</ul></li>
<li><p><code>dist_pars</code>: Distribution parameters</p></li>
<li><p><code>correlation_type</code>: Always <code>"gogarch"</code></p></li>
</ul></dd>

<dt><code>warnings</code></dt>
<dd><p>List of warning messages generated during estimation</p></dd>

<dt><code>diagnostics</code></dt>
<dd><p>Updated diagnostics object</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The estimation proceeds in two stages:</p>
<p><strong>Stage 1: ICA Decomposition</strong></p>
<p>Independent Component Analysis extracts statistically independent components
from the multivariate residuals:
$$S = Y \cdot W$$
where \(Y\) is the T x k residual matrix, \(W\) is the unmixing matrix,
and \(S\) contains the independent components.</p>
<p>The RADICAL algorithm (Learned-Miller, 2003) is used for ICA decomposition,
which is robust to outliers. For improved convergence with multiple restarts
and quality diagnostics, see <code><a href="improved_ica_decomposition.html">improved_ica_decomposition</a></code>.</p>
<p><strong>Stage 2: Component GARCH Estimation</strong></p>
<p>Univariate GARCH models are fitted to each independent component using
weighted MLE. The weights come from the state probabilities in the
Markov-Switching framework.</p>
<p><strong>Covariance Reconstruction</strong></p>
<p>The time-varying covariance matrix is reconstructed as:
$$H_t = A \cdot D_t \cdot A'$$
where \(A\) is the mixing matrix from ICA and \(D_t = \text{diag}(\sigma^2_{1,t},
\ldots, \sigma^2_{k,t})\) contains the component GARCH variances.</p>
<p><strong>Log-Likelihood</strong></p>
<p>The GOGARCH log-likelihood includes a Jacobian adjustment for the ICA
transformation:
$$LL = \sum_i LL_{component,i} + \log|det(K)|$$
where \(K\) is the pre-whitening matrix. See <code><a href="compute_gogarch_loglik_ms.html">compute_gogarch_loglik_ms</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="comparison-with-dcc-and-cgarch">Comparison with DCC and CGARCH<a class="anchor" aria-label="anchor" href="#comparison-with-dcc-and-cgarch"></a></h2>


<table class="table table"><tr><td><strong>Aspect</strong></td><td><strong>DCC</strong></td><td><strong>CGARCH</strong></td><td><strong>GOGARCH</strong></td></tr><tr><td>Correlation source</td><td>alpha, beta params</td><td>DCC on copula</td><td>ICA mixing matrix</td></tr><tr><td>Dynamics</td><td>DCC recursion</td><td>DCC/ADCC</td><td>Component volatilities</td></tr><tr><td>Marginal treatment</td><td>Assumed Normal</td><td>Flexible (PIT)</td><td>ICA components</td></tr><tr><td>Key strength</td><td>Interpretable</td><td>Tail dependence</td><td>Non-Gaussian dependence</td></tr></table></div>
    <div class="section level2">
    <h2 id="when-to-use-gogarch">When to Use GOGARCH<a class="anchor" aria-label="anchor" href="#when-to-use-gogarch"></a></h2>


<p>GOGARCH is particularly suitable when:</p><ul><li><p>The dependence structure arises from independent underlying factors</p></li>
<li><p>Heavy-tailed distributions (NIG, GH) are needed for the components</p></li>
<li><p>Dimension reduction is desired (fewer components than series)</p></li>
<li><p>Non-linear dependence structures are suspected</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="ica-quality-assessment">ICA Quality Assessment<a class="anchor" aria-label="anchor" href="#ica-quality-assessment"></a></h2>


<p>The quality of the ICA decomposition is critical for GOGARCH reliability.
Key diagnostics include:</p><ul><li><p><strong>Independence score</strong>: Measures how uncorrelated the extracted
components are (target: &gt; 0.8)</p></li>
<li><p><strong>Reconstruction error</strong>: How well Y = S * A' holds (target: &lt; 1\<!-- %) --></p></li>
<li><p><strong>Negentropy</strong>: Non-Gaussianity of components (higher = better separation</p></li>
</ul><p>If ICA convergence is problematic, consider using <code><a href="improved_ica_decomposition.html">improved_ica_decomposition</a></code>
which provides multiple restarts and automatic quality assessment. For post-estimation
diagnostics, see <code><a href="gogarch_diagnostics.html">gogarch_diagnostics</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>van der Weide, R. (2002). GO-GARCH: A multivariate generalized orthogonal
GARCH model. <em>Journal of Applied Econometrics</em>, 17(5), 549-564.</p>
<p>Learned-Miller, E. G. (2003). ICA using spacings estimates of entropy.
<em>Journal of Machine Learning Research</em>, 4, 1271-1295.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="tsbs.html">tsbs</a></code>: Main bootstrap function
(use <code>garch_spec_fun = "gogarch_modelspec"</code>)</p></li>
<li><p><code><a href="estimate_garch_weighted_univariate_gogarch.html">estimate_garch_weighted_univariate_gogarch</a></code>: Component
GARCH estimation</p></li>
<li><p><code><a href="compute_gogarch_loglik_ms.html">compute_gogarch_loglik_ms</a></code>: Log-likelihood computation</p></li>
<li><p><code><a href="improved_ica_decomposition.html">improved_ica_decomposition</a></code>: Enhanced ICA with multiple
restarts and quality metrics</p></li>
<li><p><code><a href="gogarch_diagnostics.html">gogarch_diagnostics</a></code>: Comprehensive model diagnostics
including ICA quality, component GARCH fit, and covariance reconstruction</p></li>
<li><p><code><a href="estimate_garch_weighted_dcc.html">estimate_garch_weighted_dcc</a></code>: Alternative DCC estimator</p></li>
<li><p><code><a href="estimate_garch_weighted_cgarch.html">estimate_garch_weighted_cgarch</a></code>: Alternative CGARCH estimator</p></li>
</ul></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Hoshi Vognsen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

