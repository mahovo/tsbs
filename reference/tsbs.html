<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Advanced Bootstrap for Time Series — tsbs • tsbs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Bootstrap for Time Series — tsbs"><meta name="description" content="Generates bootstrap replicates of multivariate or (multiple) univariate time
series. Supports moving and stationary block, HMM, MSVAR, MS VARMA GARCH and
wild bootstrap types."><meta property="og:description" content="Generates bootstrap replicates of multivariate or (multiple) univariate time
series. Supports moving and stationary block, HMM, MSVAR, MS VARMA GARCH and
wild bootstrap types."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tsbs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bootstrap_diagnostics.html">Bootstrap Diagnostics Guide</a></li>
    <li><a class="dropdown-item" href="../articles/cgarch_vs_dcc.html">Copula GARCH vs DCC: Model Comparison and Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/dcc_inference_guide.html">DCC Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_diagnostics.html">Diagnostic System for MS-VARMA-GARCH Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ms-varma-garch_inference.html">MS-VARMA-GARCH Parameter Inference Guide</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate_garch_comparison.html">Multivariate GARCH Model Comparison: DCC, CGARCH, and GOGARCH</a></li>
    <li><a class="dropdown-item" href="../articles/portfolio-optimization-demo.html">Portfolio Optimization with Multivariate GARCH Model Comparison</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Advanced Bootstrap for Time Series</h1>

      <div class="d-none name"><code>tsbs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates bootstrap replicates of multivariate or (multiple) univariate time
series. Supports moving and stationary block, HMM, MSVAR, MS VARMA GARCH and
wild bootstrap types.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tsbs</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  block_length <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bs_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"moving"</span>, <span class="st">"stationary"</span>, <span class="st">"hmm"</span>, <span class="st">"msvar"</span>, <span class="st">"ms_varma_garch"</span>, <span class="st">"wild"</span><span class="op">)</span>,</span>
<span>  block_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"overlapping"</span>, <span class="st">"non-overlapping"</span>, <span class="st">"tapered"</span><span class="op">)</span>,</span>
<span>  taper_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cosine"</span>, <span class="st">"bartlett"</span>, <span class="st">"tukey"</span><span class="op">)</span>,</span>
<span>  tukey_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  num_blocks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_boots <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  func <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  apply_func_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cols"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  p_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1/n"</span>, <span class="st">"plugin"</span>, <span class="st">"cv"</span><span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overlap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  num_states <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  spec <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"univariate"</span>, <span class="st">"multivariate"</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  model_func <span class="op">=</span> <span class="va">default_model_func</span>,</span>
<span>  score_func <span class="op">=</span> <span class="va">mse</span>,</span>
<span>  stationary_max_percentile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  stationary_max_fraction_of_n <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  return_fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fail_mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"predictably"</span>, <span class="st">"gracefully"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric vector, matrix, data frame or time series observations
(rows = time points, cols = variables).</p></dd>


<dt id="arg-n-boot">n_boot<a class="anchor" aria-label="anchor" href="#arg-n-boot"></a></dt>
<dd><p>Integer, optional desired length of each bootstrap replicate.
See details below.</p></dd>


<dt id="arg-block-length">block_length<a class="anchor" aria-label="anchor" href="#arg-block-length"></a></dt>
<dd><p>Integer, length of each block. If <code>NULL</code>, an automatic
heuristic is used: The method first calculates the average absolute
first-order autocorrelation (\(\rho_1\)) across all time series columns.
A candidate block length is then calculated based on this persistence
measure using the formula \(⌊10/(1−\rho_1)⌋\). The final block length is
constrained to be between 5 and the square root of the series length.
For stationary bootstrap, <code>block_length</code> is the expected block length, when
<code>p_method="1/n"</code>.</p></dd>


<dt id="arg-bs-type">bs_type<a class="anchor" aria-label="anchor" href="#arg-bs-type"></a></dt>
<dd><p>Bootstrap type. Character string: One of <code>"moving"</code>,
<code>"stationary"</code>, <code>"hmm"</code>, <code>"msvar"</code>, <code>"ms_varma_garch"</code>, or <code>"wild"</code>.
<code>"msvar"</code> is a lightweight special case of <code>"ms_varma_garch"</code>. See details
below.</p></dd>


<dt id="arg-block-type">block_type<a class="anchor" aria-label="anchor" href="#arg-block-type"></a></dt>
<dd><p>Block type. Character string: One of <code>"non-overlapping"</code>,
<code>"overlapping"</code>, or <code>"tapered"</code>. Only affects <code>bs_type="moving"</code> and
<code>bs_type="stationary"</code>. <code>block_type="tapered"</code> will smooth out transitions
between blocks. It follows that <code>block_type="tapered"</code> can not be used when
<code>block_length=1</code>.</p></dd>


<dt id="arg-taper-type">taper_type<a class="anchor" aria-label="anchor" href="#arg-taper-type"></a></dt>
<dd><p>Tapering window function. Character. One of <code>"cosine"</code>,
<code>"bartlett"</code>, or <code>"tukey"</code>. Only affects <code>block_type="tapered"</code>. See
details below.</p></dd>


<dt id="arg-tukey-alpha">tukey_alpha<a class="anchor" aria-label="anchor" href="#arg-tukey-alpha"></a></dt>
<dd><p>numeric, alpha parameter for <code>taper_type = "tukey"</code>.
\(\alpha \in [0, 1]\) is the fraction of the window length tapered at
each end, using indices \(0 \dots n−1\), where \(n\) is the block length.</p></dd>


<dt id="arg-num-blocks">num_blocks<a class="anchor" aria-label="anchor" href="#arg-num-blocks"></a></dt>
<dd><p>Integer number of blocks per bootstrap replicate.</p></dd>


<dt id="arg-num-boots">num_boots<a class="anchor" aria-label="anchor" href="#arg-num-boots"></a></dt>
<dd><p>Integer number of bootstrap replicates.</p></dd>


<dt id="arg-func">func<a class="anchor" aria-label="anchor" href="#arg-func"></a></dt>
<dd><p>A function to apply to each bootstrap replicate. The function's
expected input depends on the <code>apply_func_to</code> parameter:</p><ul><li><p>If <code>apply_func_to = "cols"</code>: <code>func</code> receives a single numeric
vector (one column at a time) and should return a scalar or numeric
vector. Examples: <code>mean</code>, <code>sd</code>, <code>quantile</code>.</p></li>
<li><p>If <code>apply_func_to = "all"</code>: <code>func</code> receives the entire bootstrap
replicate as a numeric matrix (rows = time points, columns = variables)
and can return:</p><ul><li><p>A numeric scalar or vector (e.g., portfolio weights)</p></li>
<li><p>A named list of numeric values (e.g., multiple summary
statistics)</p></li>
</ul><p>Examples: portfolio optimization functions, functions returning
multiple statistics.</p></li>
</ul><p>The function outputs are collected in <code>func_outs</code> (one entry per
replicate), and <code>func_out_means</code> contains the element-wise average across
replicates. For list-returning functions, each named element is averaged
separately. Default is <code>mean</code>.</p></dd>


<dt id="arg-apply-func-to">apply_func_to<a class="anchor" aria-label="anchor" href="#arg-apply-func-to"></a></dt>
<dd><p>Character string: <code>"cols"</code> to apply columnwise or <code>"all"</code>
to apply on the full data frame or matrix.</p></dd>


<dt id="arg-p-method">p_method<a class="anchor" aria-label="anchor" href="#arg-p-method"></a></dt>
<dd><p>Character string to choose method for stationary bootstrap
parameter: <code>"1/n"</code>, <code>"plugin"</code>, or <code>"cv"</code>.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>numeric \(p \in (0, 1)\). Probability parameter for the geometric
block length (used in Stationary Bootstrap).</p></dd>


<dt id="arg-overlap">overlap<a class="anchor" aria-label="anchor" href="#arg-overlap"></a></dt>
<dd><p>Logical indicating if overlapping blocks are allowed.</p></dd>


<dt id="arg-num-states">num_states<a class="anchor" aria-label="anchor" href="#arg-num-states"></a></dt>
<dd><p>Integer number of states for HMM, MSVAR, or
MS-VARMA-GARCH models.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Integer differencing order for the MS-VARMA-GARCH model.</p></dd>


<dt id="arg-spec">spec<a class="anchor" aria-label="anchor" href="#arg-spec"></a></dt>
<dd><p>A list defining the state-specific models for the MS-VARMA-GARCH
bootstrap (bs_type = "ms_varma_garch"). This argument is required for
this bootstrap type and must be a list of length <code>num_states</code>. Each element
of the list is itself a list specifying the model for that state. The
structure depends on whether the model is univariate or multivariate.
Fitting relies on the tsgarch or tsmarch packages, respectively. See
details below.</p></dd>


<dt id="arg-model-type">model_type<a class="anchor" aria-label="anchor" href="#arg-model-type"></a></dt>
<dd><p>Character string for MS-VARMA-GARCH: <code>"univariate"</code> or
<code>"multivariate"</code>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters for the MS-VARMA-GARCH EM
algorithm.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Parallelize computation? <code>TRUE</code> or <code>FALSE</code>.</p></dd>


<dt id="arg-num-cores">num_cores<a class="anchor" aria-label="anchor" href="#arg-num-cores"></a></dt>
<dd><p>Number of cores when <code>parallel=TRUE</code>.</p></dd>


<dt id="arg-model-func">model_func<a class="anchor" aria-label="anchor" href="#arg-model-func"></a></dt>
<dd><p>Model-fitting function for cross-validation.
See <a href="k_fold_cv_ts.html">k_fold_cv_ts</a>.</p></dd>


<dt id="arg-score-func">score_func<a class="anchor" aria-label="anchor" href="#arg-score-func"></a></dt>
<dd><p>Scoring function for cross-validation.</p></dd>


<dt id="arg-stationary-max-percentile">stationary_max_percentile<a class="anchor" aria-label="anchor" href="#arg-stationary-max-percentile"></a></dt>
<dd><p>Stationary max percentile.</p></dd>


<dt id="arg-stationary-max-fraction-of-n">stationary_max_fraction_of_n<a class="anchor" aria-label="anchor" href="#arg-stationary-max-fraction-of-n"></a></dt>
<dd><p>Stationary max fraction of n.</p></dd>


<dt id="arg-return-fit">return_fit<a class="anchor" aria-label="anchor" href="#arg-return-fit"></a></dt>
<dd><p>If <code>TRUE</code>, <code>tsbs()</code> will return model fit. Default is
<code>return_fit = FALSE</code>. If <code>return_fit = TRUE</code> and
<code>bs_type = "ms_varma_garch"</code>, diagnostics can be extracted from
<code>result$fit$diagnostics</code>. See <code><a href="fit_ms_varma_garch.html">?fit_ms_varma_garch</a></code>.</p></dd>


<dt id="arg-return-diagnostics">return_diagnostics<a class="anchor" aria-label="anchor" href="#arg-return-diagnostics"></a></dt>
<dd><p>If <code>TRUE</code>, returns bootstrap diagnostics including
block composition, length statistics, and quality metrics. Diagnostics are
returned in <code>result$diagnostics</code> as a <code>tsbs_diagnostics</code> object. Use
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> methods on the diagnostics for detailed analysis.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-fail-mode">fail_mode<a class="anchor" aria-label="anchor" href="#arg-fail-mode"></a></dt>
<dd><p>Character string. One of <code>"predictably"</code> (development/
debugging - fail fast on any unexpected behavior) or <code>"gracefully"</code>
(production/robust pipelines - continue despite validation errors).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><dl><dt>bootstrap_series</dt>
<dd><p>List of bootstrap replicate matrices.</p></dd>

<dt>func_outs</dt>
<dd><p>List of computed function outputs for each replicate.</p></dd>

<dt>func_out_means</dt>
<dd><p>Mean of the computed outputs across replicates.</p></dd>

<dt>fit</dt>
<dd><p>If <code>return_fit = TRUE</code>, a list containing model fit.</p></dd>

<dt>diagnostics</dt>
<dd><p>If <code>return_diagnostics = TRUE</code>, a <code>tsbs_diagnostics</code>
object containing block composition, statistics, and quality metrics.
See <code><a href="compute_bootstrap_diagnostics.html">compute_bootstrap_diagnostics</a></code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="bootstrap-types">Bootstrap types<a class="anchor" aria-label="anchor" href="#bootstrap-types"></a></h3>


<p>See documentation for the individual bootstrap functions:</p><ul><li><p>For moving or stationary block bootstraps, see <code><a href="blockBootstrap.html">blockBootstrap()</a></code></p></li>
<li><p><code><a href="hmm_bootstrap.html">hmm_bootstrap()</a></code></p></li>
<li><p><code><a href="msvar_bootstrap.html">msvar_bootstrap()</a></code></p></li>
<li><p><code><a href="ms_varma_garch_bs.html">ms_varma_garch_bs()</a></code></p></li>
<li><p><code><a href="wild_bootstrap.html">wild_bootstrap()</a></code></p></li>
</ul><div class="section">
<h4 id="bs-type-moving-"><code>bs_type="moving"</code><a class="anchor" aria-label="anchor" href="#bs-type-moving-"></a></h4>


<p>If <code>n_boot</code> is set, the last block will be truncated when necessary to
match the length (<code>n_boot</code>) of the bootstrap series. If <code>n_boot</code> is not
set, <code>block_length</code> and <code>num_blocks</code> must be set, and <code>n_boot</code> will
automatically be set to <code>block_length * num_blocks</code>.</p>
</div>

<div class="section">
<h4 id="bs-type-stationary-bs-type-hmm-bs-type-msvar-if-n-boot-is"><code>bs_type="stationary"</code>, <code>bs_type="hmm"</code>, <code>bs_type="msvar"</code> If <code>n_boot</code> is<a class="anchor" aria-label="anchor" href="#bs-type-stationary-bs-type-hmm-bs-type-msvar-if-n-boot-is"></a></h4>


<p>set, the last block will be truncated when necessary to match the length
(<code>n_boot</code>) of the bootstrap series. This is the only way to ensure equal
length of all bootstrap series, as the length of each block is random. If
<code>n_boot</code> is not set, <code>num_blocks</code> must be set, and the length of each
bootstrap series will be determined by the number of blocks and the lengths
of the individual blocks for that particular series. Truncation ensures equal
length of bootstrapped series for bootstrap types with random block length.
For stationary bootstrap, <code>block_length</code> is the expected block length, when
<code>p_method="1/n"</code>.</p>
</div>

<div class="section">
<h4 id="bs-type-wild-"><code>bs_type="wild"</code><a class="anchor" aria-label="anchor" href="#bs-type-wild-"></a></h4>


<p><code>n_boot</code>, <code>block_length</code> and <code>num_blocks</code> are ignored. The length of the
bootstrap series is always the same as the original series.</p>
</div>

<div class="section">
<h4 id="bs-type-ms-varma-garch-"><code>bs_type = "ms_varma_garch"</code><a class="anchor" aria-label="anchor" href="#bs-type-ms-varma-garch-"></a></h4>


<p><code>spec</code> list structure:</p>
<ul><li><p><strong>For univariate models (one-column x):</strong>
Each element spec[[j]] must be a list with the following components. For a
complete list of all possible arguments (e.g., for different GARCH model
flavors), please refer to the documentation for the tsgarch package
(<code><a href="https://rdrr.io/pkg/tsgarch/man/tsgarch-package.html" class="external-link">?tsgarch</a></code> and
<code><a href="https://cran.rstudio.com/web/packages/tsgarch/vignettes/garch_models.pdf" class="external-link">vignette("garch_models", package = "tsgarch")</a></code>).</p><ul><li><p><code>arma_order</code>: A numeric vector c(p,q) for the ARMA(p,q) order.</p></li>
<li><p><code>garch_model</code>: A character string for the GARCH model type
(e.g., "garch", "egarch").</p></li>
<li><p><code>garch_order</code>: A numeric vector c(g,h) for the GARCH(g,h) order.</p></li>
<li><p><code>distribution</code>: A character string for the conditional
distribution.</p><ul><li><p><code>"norm"</code> = Normal</p></li>
<li><p><code>"snorm"</code> = Skew normal</p></li>
<li><p><code>"std"</code> = Student t</p></li>
<li><p><code>"sstd"</code> = Skew Student</p></li>
<li><p><code>"ged"</code>  = Generalized error</p></li>
<li><p><code>"ged"</code>  = Skew generalized error</p></li>
<li><p><code>"ghyp"</code>  = Generalized hyperbolic</p></li>
<li><p><code>"ghst"</code>  = Generalized hyperbolic skew Student</p></li>
<li><p><code>"jsu"</code>  = Johnson reparameterized SU</p></li>
</ul><p>See <a href="https://www.nopredict.com/packages/tsdistributions" class="external-link">https://www.nopredict.com/packages/tsdistributions</a>.</p></li>
<li><p><code>start_pars</code>: A list containing the starting parameters for
the optimization, with two named elements:</p><ul><li><p><code>arma_pars</code>: A named numeric vector for the ARMA parameters
(e.g., c(ar1 = 0.5)).</p></li>
<li><p><code>garch_pars</code>: A named list for the GARCH parameters (e.g.,
list(omega = 0.1, alpha1 = 0.1, beta1 = 0.8)).</p></li>
<li><p><code>dist_pars</code>: A named list for the starting values for
univariate dist params (e.g. list(skew = 1.0, shape = 6.0)).</p></li>
</ul></li>
</ul></li>
<li><p><strong>For multivariate models (multi-column x):</strong>
Each element spec[[j]] must be a list with the following components. For a
complete list of all possible arguments, please refer to the documentation
for the relevant tsmarch specification function. For a DCC model see
<code><a href="https://rdrr.io/pkg/tsmarch/man/dcc_modelspec.html" class="external-link">?dcc_modelspec.tsgarch.multi_estimate</a></code>, for a Copula GARCH model see
<code><a href="https://rdrr.io/pkg/tsmarch/man/cgarch_modelspec.html" class="external-link">?cgarch_modelspec.tsgarch.multi_estimate</a></code>. (See also <code><a href="https://rdrr.io/pkg/tsmarch/man/tsmarch-package.html" class="external-link">?tsmarch</a></code>,
<code><a href="https://cran.rstudio.com/web/packages/tsmarch/vignettes/tsmarch_demo.html" class="external-link">vignette("tsmarch_demo", package = "tsmarch")</a></code> and
<code><a href="https://cran.rstudio.com/web/packages/tsmarch/vignettes/feasible_multivariate_garch.pdf" class="external-link">vignette("feasible_multivariate_garch", package = "tsmarch")</a></code>.)</p><ul><li><p><code>var_order</code>: An integer p for the VAR(p) order.</p></li>
<li><p><code>garch_spec_fun</code>: A character string with the name of the
tsmarch specification function to use (e.g., "dcc_modelspec",
"gogarch_modelspec").</p></li>
<li><p><code>distribution</code>: The multivariate distribution. Valid
choices are "mvn" (for multivariate normal) and "mvt" (for
multivariate Student's t).</p></li>
<li><p><code>garch_spec_args</code>: A list of arguments to pass to the function
specified in garch_spec_fun. Key arguments include:</p><ul><li><p>For models like DCC or CGARCH, this list must also contain a
<code>garch_model</code> definition for the underlying univariate GARCH
fits.
Note: With the exception of the Copula model, the marginal
distributions of the univariate GARCH models should always be
Normal, irrespective of whether a multivariate Normal or Student is
chosen as the DCC model distribution. There are no checks performed
for this and it is up to the user to ensure that this is the case.</p></li>
</ul></li>
<li><p><code>start_pars</code>: A list containing the starting parameters, with
two named elements:</p><ul><li><p><code>var_pars</code>: A numeric vector for the VAR parameters,
stacked column by column (intercept, lags for eq1, intercept, lags
for eq2, ...).</p></li>
<li><p><code>garch_pars</code>: A list of named lists for the multivariate
GARCH parameters, e.g.
<code>replicate(k, list(omega = 0.05, alpha1 = 0.08, beta1 = 0.85), simplify = FALSE)</code>.</p></li>
<li><p><code>dcc pars</code>: A named list, e.g.
<code>list(alpha_1 = 0.05, beta_1 = 0.90)</code>.</p></li>
<li><p><code>dist pars</code>: A named list, e.g.
<code>list(shape = 8.0)</code>.</p></li>
</ul></li>
</ul></li>
</ul></div>

<div class="section">
<h4 id="dcc-dynamic-conditional-correlation-models">DCC (Dynamic Conditional Correlation) Models<a class="anchor" aria-label="anchor" href="#dcc-dynamic-conditional-correlation-models"></a></h4>


<p>DCC models capture time-varying correlations between multiple series by
modeling the correlation dynamics directly on standardized residuals. This
is the standard approach for multivariate GARCH modeling in the tsbs package.</p>
<p>To use DCC, set <code>garch_spec_fun = "dcc_modelspec"</code> in your spec.
See <code><a href="https://rdrr.io/pkg/tsmarch/man/dcc_modelspec.generic.html" class="external-link">tsmarch::dcc_modelspec()</a></code> for the tsmarch specification function.</p>
<p><strong>DCC-specific <code>garch_spec_args</code>:</strong></p><ul><li><p><code>dcc_order</code>: Integer vector c(p, q) for DCC(p, q) order. Default is
c(1, 1). Note: DCC(1,1) uses analytical gradients; higher orders use
numerical differentiation.</p></li>
<li><p><code>dynamics</code>: Character. Correlation dynamics type:</p><ul><li><p><code>"constant"</code>: Time-invariant correlation (reduces to CCC model)</p></li>
<li><p><code>"dcc"</code>: Standard DCC dynamics</p></li>
<li><p><code>"adcc"</code>: Asymmetric DCC (negative shocks have larger impact)</p></li>
</ul></li>
<li><p><code>distribution</code>: Character. Multivariate distribution:</p><ul><li><p><code>"mvn"</code>: Multivariate Normal</p></li>
<li><p><code>"mvt"</code>: Multivariate Student-t (adds shape parameter)</p></li>
</ul></li>
</ul><p><strong>Important</strong>: For DCC models, the univariate GARCH distributions should
always be Normal (<code>distribution = "norm"</code>), regardless of whether the
multivariate distribution is MVN or MVT. The multivariate distribution
applies to the joint model, not the marginals.</p>
<p><strong>Example DCC specification:</strong></p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>spec_dcc <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">var_order =</span> <span class="dv">1</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">garch_spec_fun =</span> <span class="st">"dcc_modelspec"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">"mvn"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">garch_spec_args =</span> <span class="fu">list</span>(</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="at">dcc_order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>      <span class="at">dynamics =</span> <span class="st">"dcc"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>      <span class="at">distribution =</span> <span class="st">"mvn"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>      <span class="at">garch_model =</span> <span class="fu">list</span>(<span class="at">univariate =</span> <span class="fu">list</span>(</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"garch"</span>, <span class="at">garch_order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"norm"</span>),</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"garch"</span>, <span class="at">garch_order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"norm"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>      ))</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    ),</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    <span class="at">start_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>      <span class="at">var_pars =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>      <span class="at">garch_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.05</span>, <span class="at">alpha1 =</span> <span class="fl">0.08</span>, <span class="at">beta1 =</span> <span class="fl">0.85</span>),</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.05</span>, <span class="at">alpha1 =</span> <span class="fl">0.08</span>, <span class="at">beta1 =</span> <span class="fl">0.85</span>)</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>      ),</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>      <span class="at">dcc_pars =</span> <span class="fu">list</span>(<span class="at">alpha_1 =</span> <span class="fl">0.05</span>, <span class="at">beta_1 =</span> <span class="fl">0.90</span>),</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>      <span class="at">dist_pars =</span> <span class="cn">NULL</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>    )</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  )</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>)</span></code></pre><p></p></div>
<p>For ADCC (asymmetric correlation dynamics), use <code>dynamics = "adcc"</code> and
include gamma parameters in <code>dcc_pars</code>:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>dcc_pars <span class="ot">=</span> <span class="fu">list</span>(<span class="at">alpha_1 =</span> <span class="fl">0.05</span>, <span class="at">gamma_1 =</span> <span class="fl">0.03</span>, <span class="at">beta_1 =</span> <span class="fl">0.90</span>)</span></code></pre><p></p></div>
</div>


</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Harris, F. J. (1978). "On the Use of Windows for
Harmonic Analysis with the Discrete Fourier Transform." (Proceedings of the
IEEE, 66(1), pp. 66f)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="https://rdrr.io/pkg/tsmarch/man/dcc_modelspec.generic.html" class="external-link">tsmarch::dcc_modelspec()</a></code> for creating DCC specifications</p></li>
<li><p><code><a href="estimate_garch_weighted_dcc.html">estimate_garch_weighted_dcc()</a></code> for the weighted estimation method</p></li>
<li><p><code><a href="../articles/cgarch_vs_dcc.html">vignette("cgarch_vs_dcc", package = "tsbs")</a></code> for model comparison</p></li>
</ul><div class="section">
<h3 id="copula-garch-cgarch-models">Copula GARCH (CGARCH) Models<a class="anchor" aria-label="anchor" href="#copula-garch-cgarch-models"></a></h3>


<p>Copula GARCH models provide an alternative to DCC for modeling dynamic
correlations in multivariate time series. While DCC directly models
correlation dynamics, CGARCH separates marginal distributions from the
dependence structure using copulas.</p>
<p>To use CGARCH instead of DCC, set <code>garch_spec_fun = "cgarch_modelspec"</code> in
your spec. See <code><a href="https://rdrr.io/pkg/tsmarch/man/cgarch_modelspec.generic.html" class="external-link">tsmarch::cgarch_modelspec()</a></code> for the tsmarch specification function.</p>
<p><strong>Key differences from DCC:</strong></p><ul><li><p>Uses Probability Integral Transform (PIT) to transform standardized
residuals to uniform margins before modeling dependence</p></li>
<li><p>Supports multiple transformation methods: "parametric", "empirical",
or "spd" (semi-parametric distribution)</p></li>
<li><p>Copula distribution can be "mvn" (Gaussian) or "mvt" (Student-t)</p></li>
<li><p>More flexible tail dependence modeling with Student-t copula</p></li>
</ul><p><strong>CGARCH-specific <code>garch_spec_args</code>:</strong></p><ul><li><p><code>transformation</code>: Character. Method for PIT transformation:</p><ul><li><p><code>"parametric"</code>: Uses fitted univariate distribution CDFs</p></li>
<li><p><code>"empirical"</code>: Uses empirical CDFs (non-parametric)</p></li>
<li><p><code>"spd"</code>: Semi-parametric distribution combining kernel density
in the center with parametric tails</p></li>
</ul></li>
<li><p><code>copula</code>: Character. Copula distribution: <code>"mvn"</code> or <code>"mvt"</code></p></li>
<li><p><code>dynamics</code>: Character. Correlation dynamics type:</p><ul><li><p><code>"constant"</code>: Time-invariant correlation</p></li>
<li><p><code>"dcc"</code>: Dynamic Conditional Correlation</p></li>
<li><p><code>"adcc"</code>: Asymmetric DCC (captures leverage effects where
negative returns have larger impact on correlation)</p></li>
</ul></li>
<li><p><code>dcc_order</code>: Integer vector c(p, q) for DCC/ADCC order</p></li>
</ul><p><strong>Example CGARCH specification:</strong></p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>spec_cgarch <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">var_order =</span> <span class="dv">1</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">garch_spec_fun =</span> <span class="st">"cgarch_modelspec"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">"mvn"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">garch_spec_args =</span> <span class="fu">list</span>(</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="at">dcc_order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>      <span class="at">dynamics =</span> <span class="st">"dcc"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>      <span class="at">transformation =</span> <span class="st">"parametric"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>      <span class="at">copula =</span> <span class="st">"mvn"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>      <span class="at">garch_model =</span> <span class="fu">list</span>(<span class="at">univariate =</span> <span class="fu">list</span>(</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"garch"</span>, <span class="at">garch_order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"norm"</span>),</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"garch"</span>, <span class="at">garch_order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"norm"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>      ))</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    ),</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    <span class="at">start_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>      <span class="at">var_pars =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>      <span class="at">garch_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.05</span>, <span class="at">alpha1 =</span> <span class="fl">0.08</span>, <span class="at">beta1 =</span> <span class="fl">0.85</span>),</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.05</span>, <span class="at">alpha1 =</span> <span class="fl">0.08</span>, <span class="at">beta1 =</span> <span class="fl">0.85</span>)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>      ),</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>      <span class="at">dcc_pars =</span> <span class="fu">list</span>(<span class="at">alpha_1 =</span> <span class="fl">0.05</span>, <span class="at">beta_1 =</span> <span class="fl">0.90</span>),</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>      <span class="at">dist_pars =</span> <span class="cn">NULL</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>    )</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>  )</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>)</span></code></pre><p></p></div>
<p>For ADCC (asymmetric correlation dynamics), use <code>dynamics = "adcc"</code> and
include gamma parameters:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>garch_spec_args <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="at">dynamics =</span> <span class="st">"adcc"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  ...</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>start_pars <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  ...</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">dcc_pars =</span> <span class="fu">list</span>(<span class="at">alpha_1 =</span> <span class="fl">0.05</span>, <span class="at">gamma_1 =</span> <span class="fl">0.02</span>, <span class="at">beta_1 =</span> <span class="fl">0.90</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>)</span></code></pre><p></p></div>
</div>

<ul><li><p><code><a href="https://rdrr.io/pkg/tsmarch/man/dcc_modelspec.generic.html" class="external-link">tsmarch::dcc_modelspec()</a></code> for creating DCC specifications</p></li>
<li><p><code><a href="https://rdrr.io/pkg/tsmarch/man/cgarch_modelspec.generic.html" class="external-link">tsmarch::cgarch_modelspec()</a></code> for creating CGARCH specifications</p></li>
<li><p><code><a href="estimate_garch_weighted_dcc.html">estimate_garch_weighted_dcc()</a></code> for DCC weighted estimation</p></li>
<li><p><code><a href="estimate_garch_weighted_cgarch.html">estimate_garch_weighted_cgarch()</a></code> for CGARCH weighted estimation</p></li>
<li><p><code><a href="compute_pit_transform.html">compute_pit_transform()</a></code> for PIT transformation details</p></li>
<li><p><code><a href="adcc_recursion.html">adcc_recursion()</a></code> for asymmetric DCC dynamics</p></li>
<li><p><code><a href="../articles/cgarch_vs_dcc.html">vignette("cgarch_vs_dcc", package = "tsbs")</a></code> for model comparison</p></li>
<li><p><code>vignette("Diagnostics", package = "tsbs")</code> for diagnostic system</p></li>
</ul><p><strong>GOGARCH-specific <code>garch_spec_args</code>:</strong></p><ul><li><p><code>model</code>: Character. GARCH model type for components. Default <code>"garch"</code>.</p></li>
<li><p><code>order</code>: Integer vector c(p, q) for GARCH order. Default <code>c(1, 1)</code>.</p></li>
<li><p><code>ica</code>: Character. ICA algorithm:</p><ul><li><p><code>"radical"</code>: RADICAL algorithm (recommended, robust to outliers)</p></li>
<li><p><code>"fastica"</code>: FastICA algorithm (currently not supported by tsbs,
waiting for tsmarch v1.0.1 to appear on CRAN...)</p></li>
</ul></li>
<li><p><code>components</code>: Integer. Number of ICA components to extract.
Default equals number of series. Set lower for dimension reduction.</p></li>
<li><p><code>lambda_range</code>: Numeric vector c(min, max) for GH lambda parameter.</p></li>
<li><p><code>shape_range</code>: Numeric vector c(min, max) for GH shape parameter.</p></li>
</ul><p><strong>GOGARCH Distributions:</strong></p><ul><li><p><code>"norm"</code>: Normal distribution (simplest, fastest)</p></li>
<li><p><code>"nig"</code>: Normal Inverse Gaussian (captures skewness and kurtosis)</p></li>
<li><p><code>"gh"</code>: Generalized Hyperbolic (most flexible, includes NIG as
special case)</p></li>
</ul><p><strong>Example GOGARCH specification (Normal):</strong></p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>spec_gogarch <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">var_order =</span> <span class="dv">0</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">garch_spec_fun =</span> <span class="st">"gogarch_modelspec"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">"norm"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">garch_spec_args =</span> <span class="fu">list</span>(</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="at">model =</span> <span class="st">"garch"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>      <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>      <span class="at">ica =</span> <span class="st">"radical"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>      <span class="at">components =</span> <span class="dv">2</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    ),</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    <span class="at">start_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>      <span class="at">var_pars =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>      <span class="at">garch_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.1</span>, <span class="at">alpha1 =</span> <span class="fl">0.1</span>, <span class="at">beta1 =</span> <span class="fl">0.8</span>),</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.1</span>, <span class="at">alpha1 =</span> <span class="fl">0.1</span>, <span class="at">beta1 =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>      ),</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>      <span class="at">dist_pars =</span> <span class="cn">NULL</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>    )</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  )</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>)</span></code></pre><p></p></div>
<p><strong>Example GOGARCH specification (NIG distribution):</strong></p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>spec_gogarch_nig <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">var_order =</span> <span class="dv">0</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">garch_spec_fun =</span> <span class="st">"gogarch_modelspec"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">"nig"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">garch_spec_args =</span> <span class="fu">list</span>(</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="at">model =</span> <span class="st">"garch"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>      <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>      <span class="at">ica =</span> <span class="st">"radical"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>      <span class="at">components =</span> <span class="dv">2</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    ),</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    <span class="at">start_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>      <span class="at">var_pars =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>      <span class="at">garch_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.1</span>, <span class="at">alpha1 =</span> <span class="fl">0.1</span>, <span class="at">beta1 =</span> <span class="fl">0.8</span>),</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.1</span>, <span class="at">alpha1 =</span> <span class="fl">0.1</span>, <span class="at">beta1 =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>      ),</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>      <span class="at">dist_pars =</span> <span class="fu">list</span>(<span class="at">skew =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="dv">1</span>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>    )</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  )</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>)</span></code></pre><p></p></div>
<p><strong>Example GOGARCH specification (GH distribution):</strong></p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>spec_gogarch_gh <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">var_order =</span> <span class="dv">0</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">garch_spec_fun =</span> <span class="st">"gogarch_modelspec"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">"gh"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">garch_spec_args =</span> <span class="fu">list</span>(</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="at">model =</span> <span class="st">"garch"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>      <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>      <span class="at">ica =</span> <span class="st">"radical"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>      <span class="at">components =</span> <span class="dv">2</span>,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>      <span class="at">lambda_range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>      <span class="at">shape_range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">25</span>)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    ),</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    <span class="at">start_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>      <span class="at">var_pars =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>      <span class="at">garch_pars =</span> <span class="fu">list</span>(</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.1</span>, <span class="at">alpha1 =</span> <span class="fl">0.1</span>, <span class="at">beta1 =</span> <span class="fl">0.8</span>),</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">omega =</span> <span class="fl">0.1</span>, <span class="at">alpha1 =</span> <span class="fl">0.1</span>, <span class="at">beta1 =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>      ),</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>      <span class="at">dist_pars =</span> <span class="fu">list</span>(<span class="at">skew =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>    )</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  )</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>)</span></code></pre><p></p></div>
<ul><li><p><code><a href="https://rdrr.io/pkg/tsmarch/man/gogarch_modelspec.html" class="external-link">tsmarch::gogarch_modelspec()</a></code> for creating GOGARCH specifications</p></li>
<li><p><code><a href="estimate_garch_weighted_gogarch.html">estimate_garch_weighted_gogarch()</a></code> for GOGARCH weighted estimation</p></li>
<li><p><code><a href="https://rdrr.io/pkg/tsmarch/man/radical.html" class="external-link">tsmarch::radical()</a></code> for the RADICAL ICA algorithm</p></li>
<li><p><code><a href="compute_gogarch_loglik_ms.html">compute_gogarch_loglik_ms()</a></code> for GOGARCH log-likelihood computation</p></li>
<li><p><code><a href="../articles/cgarch_vs_dcc.html">vignette("cgarch_vs_dcc", package = "tsbs")</a></code> for model comparison</p></li>
</ul><div class="section">
<h3 id="diagnostics-for-ms-varma-garch">Diagnostics for MS VARMA GARCH<a class="anchor" aria-label="anchor" href="#diagnostics-for-ms-varma-garch"></a></h3>


<p>Diagnostic System: A comprehensive diagnostic system monitors
convergence and numerical stability during estimation.
Additional parameters when <code>bs_type
= "ms_varma_garch"</code></p><ul><li><p><code>collect_diagnostics</code> Logical. Enable diagnostics with
<code>collect_diagnostics = TRUE</code>. Diagnostics can only be extracted if
<code>return_fit = TRUE</code>.</p></li>
<li><p><code>verbose</code> Logical. If TRUE, print detailed diagnostic information
during estimation. Default is FALSE.</p></li>
<li><p><code>verbose_file</code> Character string specifying path to file for
verbose output. If NULL (default), verbose output goes to console. If
specified, all verbose output is written to this file instead. Only used if
verbose = TRUE.</p></li>
</ul><p>See details in <code>vignette("Diagnostics", package = "tsbs")</code>.</p>
</div>

<div class="section">
<h3 id="taper-type-when-block-type-tapered-"><code>taper_type</code> when <code>block_type="tapered"</code><a class="anchor" aria-label="anchor" href="#taper-type-when-block-type-tapered-"></a></h3>


<p>For block length \(n\), and index \(i\) within the block, and \(0 \leq i \leq n\),</p><ul><li><p><code>"cosine"</code>: Hann window
$$w(i) = \dfrac{1}{2} \left(1 - \cos \left( \dfrac{2 \pi i}{n - i} \right ) \right)$$</p></li>
<li><p><code>"bartlett"</code>: Triangular window
$$w(i) = 1 - \left | \dfrac{i - (n - 1) / 2}{(n - 1) / 2} \right |,\ \ \ \alpha \in [0, 1]$$</p></li>
<li><p><code>"tukey"</code>: Cosine tapered window. At \(\alpha = 0\) it becomes
rectangular, and at \(\alpha = 1\) it becomes a Hann window.</p>
<p>We implement the Tukey (tapered cosine) window using the convention
\(i = 0, \dots, n-1\) for a window of length \(n\) and taper
parameter \(\alpha \in [0,1]\), consistent with common numerical
libraries such as MATLAB and SciPy (see MATLAB tukeywin,
SciPy scipy.signal.windows.tukey). After index shift and reflection this
is algebraically equivalent to the classical definition in Harris (1978),
which instead centers the index symmetrically around zero.</p>
<p>Let \(N = n - 1\) be the last index of the block, and let the running
index be \(i = 0, 1, \dots, N\).</p>
<p>The window weights \(w[i]\) are defined piecewise as follows:</p><ol><li><p>Left taper region (\(0 \le i &lt; \alpha N / 2\)):
\(
      w[i] = \frac{1}{2} \left[ 1 + \cos\left( \pi \left( \frac{2 i}{\alpha N} - 1 \right) \right) \right]
    \)</p></li>
<li><p>Central (non-tapered) region (\(\alpha N / 2 \le i \le N (1 - \alpha/2)\)):
\(
      w[i] = 1
    \)</p></li>
<li><p>Right taper region (\(N (1 - \alpha/2) &lt; i \le N\)):
\(
      w[i] = \frac{1}{2} \left[ 1 + \cos\left( \pi \left( \frac{2 i}{\alpha N} - \frac{2}{\alpha} + 1 \right) \right) \right]
    \)</p></li>
</ol></li>
</ul><p>(Harris, 1978)</p>
</div>
</div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">tsbs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  block_length <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  bs_type <span class="op">=</span> <span class="st">"stationary"</span>,</span></span>
<span class="r-in"><span>  num_blocks <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  num_boots <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  func <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>  apply_func_to <span class="op">=</span> <span class="st">"cols"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">func_out_means</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02802642</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Hoshi Vognsen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

