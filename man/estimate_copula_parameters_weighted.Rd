% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CGARCH_PACKAGE_DOCUMENTATION.R, R/cgarch.R
\name{estimate_copula_parameters_weighted}
\alias{estimate_copula_parameters_weighted}
\title{Estimate Copula Parameters with Weighted Likelihood}
\usage{
estimate_copula_parameters_weighted(
  residuals,
  weights,
  garch_pars,
  dcc_start_pars,
  dist_start_pars,
  spec,
  transformation = "parametric",
  copula_dist = "mvn",
  dynamics = "dcc",
  diagnostics = NULL,
  iteration = NULL,
  state = NULL,
  verbose = FALSE
)
}
\arguments{
\item{residuals}{T x k matrix of residuals}

\item{weights}{T-vector of observation weights}

\item{garch_pars}{List of GARCH parameters per series}

\item{dcc_start_pars}{Named list of starting DCC parameters}

\item{dist_start_pars}{Named list of distribution parameters (e.g., shape)}

\item{spec}{Model specification list}

\item{transformation}{Type of PIT transformation ("parametric", "empirical", "spd")}

\item{copula_dist}{Copula distribution ("mvn" or "mvt")}

\item{dynamics}{Correlation dynamics ("constant", "dcc", or "adcc")}

\item{diagnostics}{Diagnostics object (optional)}

\item{iteration}{Current EM iteration (optional)}

\item{state}{Current regime state (optional)}

\item{verbose}{Logical; print diagnostic information}
}
\value{
List with dcc_pars, dist_pars, weighted_ll, warnings

List with dcc_pars, dist_pars, weighted_ll, warnings, diagnostics
}
\description{
Stage 2 of copula GARCH estimation: estimates the copula dependence
parameters given Stage 1 univariate GARCH fits.

Estimates copula correlation parameters using weighted maximum likelihood.
This function handles the copula-specific transformation from standardized
residuals to uniform margins before applying the DCC-style correlation dynamics.
}
\details{
This function handles:
\itemize{
\item PIT transformation of standardized residuals
\item Computation of copula residuals
\item Optimization of DCC/ADCC parameters
\item Distribution shape estimation for MVT copula
}

The optimization strategy depends on the model:
\itemize{
\item \strong{DCC(1,1)}: Analytical gradient with (ψ, φ) reparameterization
\item \strong{DCC(p,q)}: Numerical gradient with box constraints
\item \strong{ADCC}: Numerical gradient with (α, γ, β) parameterization
}
}
\seealso{
\code{\link[=copula_gradient]{copula_gradient()}} for analytical gradients
}
\keyword{internal}
