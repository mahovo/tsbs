% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cgarch.R
\name{estimate_garch_weighted_cgarch}
\alias{estimate_garch_weighted_cgarch}
\title{Copula GARCH Weighted Estimation (Two-Stage)}
\usage{
estimate_garch_weighted_cgarch(
  residuals,
  weights,
  spec,
  diagnostics = NULL,
  iteration = NULL,
  state = NULL,
  verbose = FALSE,
  dcc_threshold = 0.02,
  dcc_criterion = "bic",
  force_constant = FALSE
)
}
\arguments{
\item{residuals}{Matrix of residuals (T x k)}

\item{weights}{Vector of observation weights (length T)}

\item{spec}{Model specification list containing:
\itemize{
\item garch_spec_fun: "cgarch_modelspec"
\item garch_spec_args: list with dcc_order, dynamics, transformation, copula,
garch_model (univariate specs)
\item start_pars: starting parameter values
\item distribution: copula distribution ("mvn" or "mvt")
}}

\item{diagnostics}{Optional diagnostics collector object}

\item{iteration}{Current EM iteration number}

\item{state}{Current regime state index}

\item{verbose}{Logical; print diagnostic information}

\item{dcc_threshold}{Threshold for DCC degeneracy detection (default 0.02)}

\item{dcc_criterion}{Selection criterion for constant vs dynamic ("bic", "aic", "threshold")}

\item{force_constant}{Logical; if TRUE, skip dynamic estimation}
}
\value{
List with:
\itemize{
\item coefficients: list with garch_pars, dcc_pars, dist_pars, correlation_type
\item warnings: list of warning messages
\item diagnostics: updated diagnostics object
}
}
\description{
Implements weighted MLE for Copula GARCH models.
Stage 1: Estimate univariate GARCH parameters for each series
Stage 2: Estimate copula dependence parameters (DCC dynamics + shape)
}
\details{
The Copula GARCH model differs from DCC in how it handles the dependence
structure:
\enumerate{
\item \strong{Marginal Transformation}: Standardized residuals are transformed to
uniform \link{0,1} margins via probability integral transform (PIT). The
transformation can be:
\itemize{
\item "parametric": Uses the estimated univariate distribution's CDF
\item "empirical": Uses the empirical CDF
\item "spd": Uses semi-parametric distribution (see \code{\link{fit_spd_transform}})
}
\item \strong{Copula Specification}: The uniform margins are then transformed
according to the copula distribution:
\itemize{
\item "mvn": Multivariate Normal copula (Gaussian copula)
\item "mvt": Multivariate Student-t copula
}
\item \strong{Correlation Dynamics}: Same as DCC - can be "constant", "dcc", or "adcc"
For ADCC, see \code{\link{adcc_recursion}}.
}

This function is called by the M-step of the EM algorithm in
\code{\link{fit_ms_varma_garch}} when \code{garch_spec_fun = "cgarch_modelspec"}.
}
\seealso{
\itemize{
\item \code{\link{tsbs}}: Main bootstrap function (use \code{garch_spec_fun = "cgarch_modelspec"})
\item \code{\link{estimate_copula_parameters_weighted}}: Stage 2 estimation
\item \code{\link{compute_pit_transform}}: PIT transformation methods
\item \code{\link{copula_nll}}: Copula log-likelihood
\item \code{\link{adcc_recursion}}: ADCC dynamics
\item \code{\link{estimate_garch_weighted_dcc}}: Alternative DCC estimator
}
}
\keyword{internal}
