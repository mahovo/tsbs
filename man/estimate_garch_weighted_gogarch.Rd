% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gogarch.R
\name{estimate_garch_weighted_gogarch}
\alias{estimate_garch_weighted_gogarch}
\title{Weighted GARCH Estimation for GOGARCH Models}
\usage{
estimate_garch_weighted_gogarch(
  residuals,
  weights,
  spec,
  diagnostics = NULL,
  verbose = FALSE
)
}
\arguments{
\item{residuals}{Numeric matrix of residuals with dimensions T x k, where T is
the number of observations and k is the number of series.}

\item{weights}{Numeric vector of state probabilities/weights with length T.
These weights come from the E-step of the EM algorithm in the MS-VARMA-GARCH
framework.}

\item{spec}{List containing the model specification with the following elements:
\describe{
\item{\code{garch_spec_args}}{List with:
\itemize{
\item \code{model}: GARCH model type (default: \code{"garch"}). Valid
choices are “garch” for vanilla GARCH, “gjrgarch” for asymmetric
GARCH, “egarch” for exponential GARCH, “aparch” for asymmetric
power ARCH, “csGARCH” for the component GARCH, “igarch” for the
integrated GARCH.
\item \code{order}: GARCH order as c(p, q) (default: \code{c(1, 1)})
\item \code{ica}: ICA algorithm. Currently only \code{"radical"} is
supported (via tsmarch v1.0.0)
\item \code{components}: Number of ICA components to extract
}
}
\item{\code{distribution}}{Component distribution: \code{"norm"},
\code{"nig"}, or \code{"gh"}}
\item{\code{start_pars}}{List with:
\itemize{
\item \code{garch_pars}: List of starting GARCH parameters for each
component (e.g., \code{list(list(omega=0.1, alpha1=0.1, beta1=0.8), ...)})
\item \code{dist_pars}: Distribution parameters (e.g.,
\code{list(shape=1, skew=0)} for NIG)
}
}
}}

\item{diagnostics}{Optional diagnostics collector object for logging
estimation progress and issues.}

\item{verbose}{Logical; if \code{TRUE}, print progress information during
ICA decomposition and GARCH estimation. Default is \code{FALSE}.}
}
\value{
A list with the following components:
\describe{
\item{\code{coefficients}}{List containing:
\itemize{
\item \code{garch_pars}: List of estimated GARCH parameters for each
ICA component
\item \code{ica_info}: List with ICA results:
\itemize{
\item \code{A}: Mixing matrix (k x n_components)
\item \code{W}: Unmixing matrix (n_components x k)
\item \code{K}: Pre-whitening matrix (for Jacobian)
\item \code{S}: Independent components matrix (T x n_components)
\item \code{method}: ICA algorithm used
\item \code{n_components}: Number of components extracted
}
\item \code{dist_pars}: Distribution parameters
\item \code{correlation_type}: Always \code{"gogarch"}
}
}
\item{\code{warnings}}{List of warning messages generated during estimation}
\item{\code{diagnostics}}{Updated diagnostics object}
}
}
\description{
Implements weighted maximum likelihood estimation for Generalized Orthogonal
GARCH (GOGARCH) models in the context of Markov-Switching frameworks.

GOGARCH differs fundamentally from DCC and Copula GARCH in how it models
dynamic correlations:
\itemize{
\item \strong{DCC/CGARCH}: Estimate explicit correlation dynamics parameters
(alpha, beta) that govern how correlations evolve over time.
\item \strong{GOGARCH}: Assume observations arise from independent latent
factors. Time-varying correlations emerge from the time-varying volatilities
of these factors, transformed through a fixed mixing matrix.
}
}
\details{
The estimation proceeds in two stages:

\strong{Stage 1: ICA Decomposition}

Independent Component Analysis extracts statistically independent components
from the multivariate residuals:
\deqn{S = Y \cdot W}
where \eqn{Y} is the T x k residual matrix, \eqn{W} is the unmixing matrix,
and \eqn{S} contains the independent components.

The RADICAL algorithm (Learned-Miller, 2003) is used for ICA decomposition,
which is robust to outliers. For improved convergence with multiple restarts
and quality diagnostics, see \code{\link{improved_ica_decomposition}}.

\strong{Stage 2: Component GARCH Estimation}

Univariate GARCH models are fitted to each independent component using
weighted MLE. The weights come from the state probabilities in the
Markov-Switching framework.

\strong{Covariance Reconstruction}

The time-varying covariance matrix is reconstructed as:
\deqn{H_t = A \cdot D_t \cdot A'}
where \eqn{A} is the mixing matrix from ICA and \eqn{D_t = \text{diag}(\sigma^2_{1,t},
\ldots, \sigma^2_{k,t})} contains the component GARCH variances.

\strong{Log-Likelihood}

The GOGARCH log-likelihood includes a Jacobian adjustment for the ICA
transformation:
\deqn{LL = \sum_i LL_{component,i} + \log|det(K)|}
where \eqn{K} is the pre-whitening matrix. See \code{\link{compute_gogarch_loglik_ms}}.
}
\section{Comparison with DCC and CGARCH}{

\tabular{llll}{
\strong{Aspect} \tab \strong{DCC} \tab \strong{CGARCH} \tab \strong{GOGARCH} \cr
Correlation source \tab alpha, beta params \tab DCC on copula \tab ICA mixing matrix \cr
Dynamics \tab DCC recursion \tab DCC/ADCC \tab Component volatilities \cr
Marginal treatment \tab Assumed Normal \tab Flexible (PIT) \tab ICA components \cr
Key strength \tab Interpretable \tab Tail dependence \tab Non-Gaussian dependence \cr
}
}

\section{When to Use GOGARCH}{

GOGARCH is particularly suitable when:
\itemize{
\item The dependence structure arises from independent underlying factors
\item Heavy-tailed distributions (NIG, GH) are needed for the components
\item Dimension reduction is desired (fewer components than series)
\item Non-linear dependence structures are suspected
}
}

\section{ICA Quality Assessment}{

The quality of the ICA decomposition is critical for GOGARCH reliability.
Key diagnostics include:
\itemize{
\item \strong{Independence score}: Measures how uncorrelated the extracted
components are (target: > 0.8)
\item \strong{Reconstruction error}: How well Y = S * A' holds (target: < 1\\%)
\item \strong{Negentropy}: Non-Gaussianity of components (higher = better separation
}

If ICA convergence is problematic, consider using \code{\link{improved_ica_decomposition}}
which provides multiple restarts and automatic quality assessment. For post-estimation
diagnostics, see \code{\link{gogarch_diagnostics}}.
}

\references{
van der Weide, R. (2002). GO-GARCH: A multivariate generalized orthogonal
GARCH model. \emph{Journal of Applied Econometrics}, 17(5), 549-564.

Learned-Miller, E. G. (2003). ICA using spacings estimates of entropy.
\emph{Journal of Machine Learning Research}, 4, 1271-1295.
}
\seealso{
\itemize{
\item \code{\link{tsbs}}: Main bootstrap function
(use \code{garch_spec_fun = "gogarch_modelspec"})
\item \code{\link{estimate_garch_weighted_univariate_gogarch}}: Component
GARCH estimation
\item \code{\link{compute_gogarch_loglik_ms}}: Log-likelihood computation
\item \code{\link{improved_ica_decomposition}}: Enhanced ICA with multiple
restarts and quality metrics
\item \code{\link{gogarch_diagnostics}}: Comprehensive model diagnostics
including ICA quality, component GARCH fit, and covariance reconstruction
\item \code{\link{estimate_garch_weighted_dcc}}: Alternative DCC estimator
\item \code{\link{estimate_garch_weighted_cgarch}}: Alternative CGARCH estimator
}
}
\keyword{internal}
